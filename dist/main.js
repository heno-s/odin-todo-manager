(()=>{"use strict";function t(t){const e=function(t){const{title:e,description:o,priority:d,dueDate:i,id:s}=t,n=document.createElement("div");n.classList.add("todo");const c=document.createElement("input");switch(c.type="checkbox",c.classList.add("priority"),+d){case 0:default:c.classList.add("priority-low");break;case 1:c.classList.add("priority-medium");break;case 2:c.classList.add("priority-high")}const r=document.createElement("div");r.classList.add("todo-body");const a=document.createElement("div");if(a.classList.add("todo-title"),a.textContent=e,r.appendChild(a),o){const t=document.createElement("div");t.classList.add("todo-description"),t.textContent=o.substr(0,50)+(o.length>50?"...":""),r.appendChild(t)}if(i){const t=document.createElement("div");t.classList.add("todo-due-date");const e=document.createElement("div");e.classList.add("mdi"),e.classList.add("mdi-calendar-clock-outline");const o=document.createElement("div");o.classList.add("todo-date"),o.textContent=i,t.appendChild(e),t.appendChild(o),r.appendChild(t)}const l=document.createElement("div");return l.classList.add("mdi"),l.classList.add("mdi-trash-can-outline"),n.appendChild(c),n.appendChild(r),n.appendChild(l),n.id=s,n}(t);document.querySelector(".todos").appendChild(e)}const e={toggleTodoAddForm:function(){document.querySelector(".add-task").classList.toggle("hide"),document.querySelector(".todo-form").classList.toggle("hide")},appendProject:function(t){const e=function(t){const{title:e,id:o}=t,d=document.createElement("li");d.classList.add("project"),d.id=o;const i=document.createElement("span");i.classList.add("project-name"),i.textContent=e;const s=document.createElement("div");return s.classList.add("mdi"),s.classList.add("mdi-trash-can-outline"),d.appendChild(i),d.appendChild(s),d}(t);document.querySelector(".projects").appendChild(e)},setActiveProject:function(e){!function(){const t=document.querySelector(".project.active");t&&(t.classList.remove(".ative"),document.querySelector(".todos").innerHTML="")}(),document.getElementById(e.id).classList.add("active"),function(e){e.todos.forEach(t)}(e)},appendTodo:t,showEditForm:function(t){if(document.querySelector(".todo-form").dataset.id)return null;const{title:e,description:o,priority:d,dueDate:i,id:s}=t,n=document.getElementById(t.id),c=function(){const t=document.querySelector(".todo-form").cloneNode(!0);return t.reset(),t.classList.remove("hide"),t}();return c.dataset.id=s,c.title.value=e,c.description.value=o,c.priority.value=d,c.dueDate.valueAsDate=i,n.insertAdjacentElement("afterend",c),n.classList.add("hide"),c},editTodo:function(t){const{title:e,description:o,priority:d,id:i,dueDate:s}=t,n=document.getElementById(i),c=document.querySelector(".todos .todo-form");return n.querySelector(".todo-title").textContent=e,n.querySelector(".todo-description").textContent=o.substr(0,50)+(o.length>50?"...":""),n.querySelector(".priority").value=d,n.querySelector(".todo-date").valueAsDate=s,c.remove(),n.classList.remove("hide"),!0}};class o{#t=[];#e=0;constructor(t){this.title=t,this.#e="id"+Math.random().toString(16).slice(2),e.appendProject(this),o.setActive(this)}addTodo(t){this.#t.push(t),e.appendTodo(t)}removeTodo(t){this.#t.splice(t,1)}getTodo(t){return this.#t.find((e=>e.id===t))}get id(){return this.#e}static setActive(t){o.#o=t,e.setActiveProject(t)}get todos(){return[...this.#t]}static#o;static get active(){return o.#o}}class d{checked=!1;#e=null;constructor(t,e,o,d){this.title=t,this.description=e,this.priority=o,this.dueDate=d,this.#e="id"+Math.random().toString(16).slice(2)}edit(t,o,d,i){this.title=t,this.description=o,this.priority=d,this.dueDate=i,e.editTodo(this)}get id(){return this.#e}}!function(){const t=new o("Today"),e=new d("Go out with trash","this is some randome not so short description",1,new Date),i=new d("Go shopping","this is some randome longer description about how awesome is this todo",0,new Date);t.addTodo(e),t.addTodo(i),[].push(t)}();const i=document.querySelector(".add-task"),s=document.querySelector(".todo-form"),n=document.querySelector(".todos");i.addEventListener("click",(t=>{e.toggleTodoAddForm()})),s.addEventListener("submit",(t=>{t.preventDefault();const[i,n,c,r]=[s.title.value,s.description.value,s.priority.value,s.dueDate.value],a=new d(i,n,c,r);o.active.addTodo(a),s.reset(),e.toggleTodoAddForm()})),n.addEventListener("click",(t=>{const d=t.target,i=d.closest(".todo"),s=o.active.getTodo(i.id);if(!i)return null;if("checkbox"===d.type&&(s.checked=d.checked),d.closest(".todo-body")){const t=e.showEditForm(s);if(null===t)return null;t.addEventListener("submit",(e=>{e.preventDefault();const[o,d,i,n]=[t.title.value,t.description.value,t.priority.value,t.dueDate.valueAsDate];s.edit(o,d,i,n)}),{once:!0})}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVhrRixFQUFFdkUsT0FDRlosRUFBS3VFLFFBQVVZLEVBQUVaLFNBRWpCWSxFQUFFRSxRQUFRLGNBQWUsQ0FDekIsTUFBTXpDLEVBQVdlLEVBQWtCakIsYUFBYTFDLEdBQ2hELEdBQWlCLE9BQWI0QyxFQUNBLE9BQU8sS0FHWEEsRUFBU29DLGlCQUNMLFVBQ0NDLElBQ0dBLEVBQUlDLGlCQUNKLE1BQU9oRixFQUFPQyxFQUFhQyxFQUFVQyxHQUFXLENBQzVDdUMsRUFBUzFDLE1BQU04QyxNQUNmSixFQUFTekMsWUFBWTZDLE1BQ3JCSixFQUFTeEMsU0FBUzRDLE1BQ2xCSixFQUFTdkMsUUFBUTRDLGFBRXJCakQsRUFBS3dFLEtBQUt0RSxFQUFPQyxFQUFhQyxFQUFVQyxFQUFRLEdBRXBELENBQUVpRixNQUFNLEdBRWhCLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9kaXNwbGF5Q29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9wcm9qZWN0LmpzIiwid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL3RvZG8uanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLW1hbmFnZXIvLi9zcmMvbG9hZEluaXQuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLW1hbmFnZXIvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gYXBwZW5kUHJvamVjdChwcm9qZWN0KSB7XG4gICAgY29uc3QgcHJvamVjdERPTSA9IF9jcmVhdGVQcm9qZWN0KHByb2plY3QpO1xuICAgIGNvbnN0IHByb2plY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0c1wiKTtcbiAgICBwcm9qZWN0cy5hcHBlbmRDaGlsZChwcm9qZWN0RE9NKTtcbn1cblxuZnVuY3Rpb24gX2NyZWF0ZVByb2plY3QocHJvamVjdCkge1xuICAgIGNvbnN0IHsgdGl0bGUsIGlkIH0gPSBwcm9qZWN0O1xuICAgIGNvbnN0IHByb2plY3RET00gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgcHJvamVjdERPTS5jbGFzc0xpc3QuYWRkKFwicHJvamVjdFwiKTtcbiAgICBwcm9qZWN0RE9NLmlkID0gaWQ7XG5cbiAgICBjb25zdCBwcm9qZWN0TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIHByb2plY3ROYW1lLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LW5hbWVcIik7XG4gICAgcHJvamVjdE5hbWUudGV4dENvbnRlbnQgPSB0aXRsZTtcblxuICAgIGNvbnN0IGRlbGV0ZUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaVwiKTtcbiAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoXCJtZGktdHJhc2gtY2FuLW91dGxpbmVcIik7XG5cbiAgICBwcm9qZWN0RE9NLmFwcGVuZENoaWxkKHByb2plY3ROYW1lKTtcbiAgICBwcm9qZWN0RE9NLmFwcGVuZENoaWxkKGRlbGV0ZUljb24pO1xuXG4gICAgcmV0dXJuIHByb2plY3RET007XG59XG5cbmZ1bmN0aW9uIHNldEFjdGl2ZVByb2plY3QocHJvamVjdCkge1xuICAgIF9yZW1vdmVBY3RpdmVQcm9qZWN0KCk7XG4gICAgY29uc3QgcHJvamVjdERPTSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByb2plY3QuaWQpO1xuICAgIHByb2plY3RET00uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICBfc2hvd1Byb2plY3RUb2Rvcyhwcm9qZWN0KTtcbn1cblxuZnVuY3Rpb24gX3JlbW92ZUFjdGl2ZVByb2plY3QoKSB7XG4gICAgY29uc3QgYWN0aXZlUHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC5hY3RpdmVcIik7XG4gICAgaWYgKCFhY3RpdmVQcm9qZWN0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYWN0aXZlUHJvamVjdC5jbGFzc0xpc3QucmVtb3ZlKFwiLmF0aXZlXCIpO1xuICAgIF9yZW1vdmVDdXJyZW50VG9kb3MoKTtcbn1cblxuZnVuY3Rpb24gX3JlbW92ZUN1cnJlbnRUb2RvcygpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG9zXCIpO1xuICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xufVxuXG5mdW5jdGlvbiBfc2hvd1Byb2plY3RUb2Rvcyhwcm9qZWN0KSB7XG4gICAgY29uc3QgdG9kb3MgPSBwcm9qZWN0LnRvZG9zO1xuICAgIHRvZG9zLmZvckVhY2goYXBwZW5kVG9kbyk7XG59XG5cbmZ1bmN0aW9uIGFwcGVuZFRvZG8odG9kbykge1xuICAgIGNvbnN0IHRvZG9ET00gPSBfY3JlYXRlVG9kbyh0b2RvKTtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG9zXCIpO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRvZG9ET00pO1xufVxuXG5mdW5jdGlvbiBfY3JlYXRlVG9kbyh0b2RvKSB7XG4gICAgY29uc3QgeyB0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlLCBpZCB9ID0gdG9kbztcbiAgICBjb25zdCB0b2RvRE9NID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0b2RvRE9NLmNsYXNzTGlzdC5hZGQoXCJ0b2RvXCIpO1xuXG4gICAgY29uc3QgcHJpb3JpdHlET00gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgcHJpb3JpdHlET00udHlwZSA9IFwiY2hlY2tib3hcIjtcbiAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHlcIik7XG5cbiAgICBzd2l0Y2ggKCtwcmlvcml0eSkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktbG93XCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eS1tZWRpdW1cIik7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktaGlnaFwiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcHJpb3JpdHlET00uY2xhc3NMaXN0LmFkZChcInByaW9yaXR5LWxvd1wiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGNvbnN0IHRvZG9Cb2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0b2RvQm9keS5jbGFzc0xpc3QuYWRkKFwidG9kby1ib2R5XCIpO1xuXG4gICAgY29uc3QgdG9kb1RpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0b2RvVGl0bGUuY2xhc3NMaXN0LmFkZChcInRvZG8tdGl0bGVcIik7XG4gICAgdG9kb1RpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG5cbiAgICB0b2RvQm9keS5hcHBlbmRDaGlsZCh0b2RvVGl0bGUpO1xuXG4gICAgaWYgKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIGNvbnN0IHRvZG9EZXNjcmlwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRvZG9EZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKFwidG9kby1kZXNjcmlwdGlvblwiKTtcbiAgICAgICAgdG9kb0Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID1cbiAgICAgICAgICAgIGRlc2NyaXB0aW9uLnN1YnN0cigwLCA1MCkgK1xuICAgICAgICAgICAgKGRlc2NyaXB0aW9uLmxlbmd0aCA+IDUwID8gXCIuLi5cIiA6IFwiXCIpO1xuXG4gICAgICAgIHRvZG9Cb2R5LmFwcGVuZENoaWxkKHRvZG9EZXNjcmlwdGlvbik7XG4gICAgfVxuICAgIGlmIChkdWVEYXRlKSB7XG4gICAgICAgIGNvbnN0IHRvZG9EdWVEYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdG9kb0R1ZURhdGUuY2xhc3NMaXN0LmFkZChcInRvZG8tZHVlLWRhdGVcIik7XG5cbiAgICAgICAgY29uc3QgY2FsZW5kYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBjYWxlbmRhci5jbGFzc0xpc3QuYWRkKFwibWRpXCIpO1xuICAgICAgICBjYWxlbmRhci5jbGFzc0xpc3QuYWRkKFwibWRpLWNhbGVuZGFyLWNsb2NrLW91dGxpbmVcIik7XG5cbiAgICAgICAgY29uc3QgdG9kb0RhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0b2RvRGF0ZS5jbGFzc0xpc3QuYWRkKFwidG9kby1kYXRlXCIpO1xuICAgICAgICB0b2RvRGF0ZS50ZXh0Q29udGVudCA9IGR1ZURhdGU7XG5cbiAgICAgICAgdG9kb0R1ZURhdGUuYXBwZW5kQ2hpbGQoY2FsZW5kYXIpO1xuICAgICAgICB0b2RvRHVlRGF0ZS5hcHBlbmRDaGlsZCh0b2RvRGF0ZSk7XG5cbiAgICAgICAgdG9kb0JvZHkuYXBwZW5kQ2hpbGQodG9kb0R1ZURhdGUpO1xuICAgIH1cblxuICAgIGNvbnN0IGRlbGV0ZUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaVwiKTtcbiAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoXCJtZGktdHJhc2gtY2FuLW91dGxpbmVcIik7XG5cbiAgICB0b2RvRE9NLmFwcGVuZENoaWxkKHByaW9yaXR5RE9NKTtcbiAgICB0b2RvRE9NLmFwcGVuZENoaWxkKHRvZG9Cb2R5KTtcbiAgICB0b2RvRE9NLmFwcGVuZENoaWxkKGRlbGV0ZUljb24pO1xuXG4gICAgdG9kb0RPTS5pZCA9IGlkO1xuXG4gICAgcmV0dXJuIHRvZG9ET007XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZVRvZG9BZGRGb3JtKCkge1xuICAgIGNvbnN0IGFkZFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC10YXNrXCIpO1xuICAgIGFkZFRhc2suY2xhc3NMaXN0LnRvZ2dsZShcImhpZGVcIik7XG5cbiAgICBjb25zdCB0b2RvRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1mb3JtXCIpO1xuICAgIHRvZG9Gb3JtLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRlXCIpO1xufVxuXG5mdW5jdGlvbiBfY2xvbmVUb2RvRm9ybSgpIHtcbiAgICBjb25zdCB0b2RvRm9ybSA9IGRvY3VtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZm9ybVwiKVxuICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHRvZG9Gb3JtLnJlc2V0KCk7XG4gICAgdG9kb0Zvcm0uY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG5cbiAgICByZXR1cm4gdG9kb0Zvcm07XG59XG5cbmZ1bmN0aW9uIHNob3dFZGl0Rm9ybSh0b2RvKSB7XG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1mb3JtXCIpLmRhdGFzZXQuaWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSwgaWQgfSA9IHRvZG87XG4gICAgY29uc3QgdG9kb0RPTSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRvZG8uaWQpO1xuICAgIGNvbnN0IHRvZG9Gb3JtID0gX2Nsb25lVG9kb0Zvcm0oKTtcblxuICAgIHRvZG9Gb3JtLmRhdGFzZXQuaWQgPSBpZDtcbiAgICB0b2RvRm9ybS50aXRsZS52YWx1ZSA9IHRpdGxlO1xuICAgIHRvZG9Gb3JtLmRlc2NyaXB0aW9uLnZhbHVlID0gZGVzY3JpcHRpb247XG4gICAgdG9kb0Zvcm0ucHJpb3JpdHkudmFsdWUgPSBwcmlvcml0eTtcbiAgICB0b2RvRm9ybS5kdWVEYXRlLnZhbHVlQXNEYXRlID0gZHVlRGF0ZTtcblxuICAgIHRvZG9ET00uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYWZ0ZXJlbmRcIiwgdG9kb0Zvcm0pO1xuICAgIHRvZG9ET00uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG5cbiAgICByZXR1cm4gdG9kb0Zvcm07XG59XG5cbmZ1bmN0aW9uIGVkaXRUb2RvKHRvZG8pIHtcbiAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGlkLCBkdWVEYXRlIH0gPSB0b2RvO1xuXG4gICAgY29uc3QgdG9kb0RPTSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBjb25zdCB0b2RvRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3MgLnRvZG8tZm9ybVwiKTtcblxuICAgIHRvZG9ET00ucXVlcnlTZWxlY3RvcihcIi50b2RvLXRpdGxlXCIpLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgdG9kb0RPTS5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZGVzY3JpcHRpb25cIikudGV4dENvbnRlbnQgPVxuICAgICAgICBkZXNjcmlwdGlvbi5zdWJzdHIoMCwgNTApICtcbiAgICAgICAgKGRlc2NyaXB0aW9uLmxlbmd0aCA+IDUwID8gXCIuLi5cIiA6IFwiXCIpO1xuICAgIHRvZG9ET00ucXVlcnlTZWxlY3RvcihcIi5wcmlvcml0eVwiKS52YWx1ZSA9IHByaW9yaXR5O1xuICAgIHRvZG9ET00ucXVlcnlTZWxlY3RvcihcIi50b2RvLWRhdGVcIikudmFsdWVBc0RhdGUgPSBkdWVEYXRlO1xuXG4gICAgdG9kb0Zvcm0ucmVtb3ZlKCk7XG4gICAgdG9kb0RPTS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIHRvZ2dsZVRvZG9BZGRGb3JtLFxuICAgIGFwcGVuZFByb2plY3QsXG4gICAgc2V0QWN0aXZlUHJvamVjdCxcbiAgICBhcHBlbmRUb2RvLFxuICAgIHNob3dFZGl0Rm9ybSxcbiAgICBlZGl0VG9kbyxcbn07XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXIuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvamVjdCB7XG4gICAgI3RvZG9zID0gW107XG4gICAgI2lkID0gMDtcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuI2lkID0gXCJpZFwiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMik7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmFwcGVuZFByb2plY3QodGhpcyk7XG4gICAgICAgIFByb2plY3Quc2V0QWN0aXZlKHRoaXMpO1xuICAgIH1cblxuICAgIGFkZFRvZG8odG9kbykge1xuICAgICAgICB0aGlzLiN0b2Rvcy5wdXNoKHRvZG8pO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5hcHBlbmRUb2RvKHRvZG8pO1xuICAgIH1cblxuICAgIHJlbW92ZVRvZG8oaW5kZXgpIHtcbiAgICAgICAgdGhpcy4jdG9kb3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG5cbiAgICBnZXRUb2RvKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiN0b2Rvcy5maW5kKCh0b2RvKSA9PiB0b2RvLmlkID09PSBpZCk7XG4gICAgfVxuXG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jaWQ7XG4gICAgfVxuXG4gICAgc3RhdGljIHNldEFjdGl2ZShwcm9qZWN0KSB7XG4gICAgICAgIFByb2plY3QuI2FjdGl2ZSA9IHByb2plY3Q7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLnNldEFjdGl2ZVByb2plY3QocHJvamVjdCk7XG4gICAgfVxuXG4gICAgZ2V0IHRvZG9zKCkge1xuICAgICAgICByZXR1cm4gWy4uLnRoaXMuI3RvZG9zXTtcbiAgICB9XG5cbiAgICBzdGF0aWMgI2FjdGl2ZTtcbiAgICBzdGF0aWMgZ2V0IGFjdGl2ZSgpIHtcbiAgICAgICAgcmV0dXJuIFByb2plY3QuI2FjdGl2ZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9kbyB7XG4gICAgY2hlY2tlZCA9IGZhbHNlO1xuICAgICNpZCA9IG51bGw7XG4gICAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xuICAgICAgICB0aGlzLiNpZCA9IFwiaWRcIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIpO1xuICAgIH1cblxuICAgIGVkaXQodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5lZGl0VG9kbyh0aGlzKTtcbiAgICB9XG5cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNpZDtcbiAgICB9XG59XG4iLCJpbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9wcm9qZWN0XCI7XG5pbXBvcnQgVG9kbyBmcm9tIFwiLi90b2RvXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGluaXRQYWdlKCkge1xuICAgIGNvbnN0IHByb2plY3RzID0gW107XG5cbiAgICBjb25zdCBwcm9qZWN0MSA9IG5ldyBQcm9qZWN0KFwiVG9kYXlcIik7XG5cbiAgICBjb25zdCB0b2RvMTEgPSBuZXcgVG9kbyhcbiAgICAgICAgXCJHbyBvdXQgd2l0aCB0cmFzaFwiLFxuICAgICAgICBcInRoaXMgaXMgc29tZSByYW5kb21lIG5vdCBzbyBzaG9ydCBkZXNjcmlwdGlvblwiLFxuICAgICAgICAxLFxuICAgICAgICBuZXcgRGF0ZSgpXG4gICAgKTtcbiAgICBjb25zdCB0b2RvMTIgPSBuZXcgVG9kbyhcbiAgICAgICAgXCJHbyBzaG9wcGluZ1wiLFxuICAgICAgICBcInRoaXMgaXMgc29tZSByYW5kb21lIGxvbmdlciBkZXNjcmlwdGlvbiBhYm91dCBob3cgYXdlc29tZSBpcyB0aGlzIHRvZG9cIixcbiAgICAgICAgMCxcbiAgICAgICAgbmV3IERhdGUoKVxuICAgICk7XG5cbiAgICBwcm9qZWN0MS5hZGRUb2RvKHRvZG8xMSk7XG4gICAgcHJvamVjdDEuYWRkVG9kbyh0b2RvMTIpO1xuXG4gICAgcHJvamVjdHMucHVzaChwcm9qZWN0MSk7XG59XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXJcIjtcbmltcG9ydCBpbml0UGFnZSBmcm9tIFwiLi9sb2FkSW5pdFwiO1xuaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IFRvZG8gZnJvbSBcIi4vdG9kb1wiO1xuXG5pbml0UGFnZSgpO1xuXG4vKiBFTEVNRU5UUyAqL1xuY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG5jb25zdCB0b2RvRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1mb3JtXCIpO1xuY29uc3QgdG9kb3NDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG9zXCIpO1xuXG4vKiBMSVNURU5FUlMgKi9cbmFkZFRhc2suYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBkaXNwbGF5Q29udHJvbGxlci50b2dnbGVUb2RvQWRkRm9ybSgpO1xufSk7XG5cbnRvZG9Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlXSA9IFtcbiAgICAgICAgdG9kb0Zvcm0udGl0bGUudmFsdWUsXG4gICAgICAgIHRvZG9Gb3JtLmRlc2NyaXB0aW9uLnZhbHVlLFxuICAgICAgICB0b2RvRm9ybS5wcmlvcml0eS52YWx1ZSxcbiAgICAgICAgdG9kb0Zvcm0uZHVlRGF0ZS52YWx1ZSxcbiAgICBdO1xuXG4gICAgY29uc3QgdG9kbyA9IG5ldyBUb2RvKHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUpO1xuICAgIFByb2plY3QuYWN0aXZlLmFkZFRvZG8odG9kbyk7XG4gICAgdG9kb0Zvcm0ucmVzZXQoKTtcbiAgICBkaXNwbGF5Q29udHJvbGxlci50b2dnbGVUb2RvQWRkRm9ybSgpO1xufSk7XG5cbnRvZG9zQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgY29uc3QgdCA9IGV2dC50YXJnZXQ7XG4gICAgY29uc3QgdG9kb0RPTSA9IHQuY2xvc2VzdChcIi50b2RvXCIpO1xuICAgIGNvbnN0IHRvZG8gPSBQcm9qZWN0LmFjdGl2ZS5nZXRUb2RvKHRvZG9ET00uaWQpO1xuICAgIGlmICghdG9kb0RPTSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodC50eXBlID09PSBcImNoZWNrYm94XCIpIHtcbiAgICAgICAgdG9kby5jaGVja2VkID0gdC5jaGVja2VkO1xuICAgIH1cbiAgICBpZiAodC5jbG9zZXN0KFwiLnRvZG8tYm9keVwiKSkge1xuICAgICAgICBjb25zdCB0b2RvRm9ybSA9IGRpc3BsYXlDb250cm9sbGVyLnNob3dFZGl0Rm9ybSh0b2RvKTtcbiAgICAgICAgaWYgKHRvZG9Gb3JtID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRvZG9Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICBcInN1Ym1pdFwiLFxuICAgICAgICAgICAgKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlXSA9IFtcbiAgICAgICAgICAgICAgICAgICAgdG9kb0Zvcm0udGl0bGUudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHRvZG9Gb3JtLmRlc2NyaXB0aW9uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICB0b2RvRm9ybS5wcmlvcml0eS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdG9kb0Zvcm0uZHVlRGF0ZS52YWx1ZUFzRGF0ZSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIHRvZG8uZWRpdCh0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7IG9uY2U6IHRydWUgfVxuICAgICAgICApO1xuICAgIH1cbn0pO1xuIl0sIm5hbWVzIjpbImFwcGVuZFRvZG8iLCJ0b2RvIiwidG9kb0RPTSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsImR1ZURhdGUiLCJpZCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInByaW9yaXR5RE9NIiwidHlwZSIsInRvZG9Cb2R5IiwidG9kb1RpdGxlIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsInRvZG9EZXNjcmlwdGlvbiIsInN1YnN0ciIsImxlbmd0aCIsInRvZG9EdWVEYXRlIiwiY2FsZW5kYXIiLCJ0b2RvRGF0ZSIsImRlbGV0ZUljb24iLCJfY3JlYXRlVG9kbyIsInF1ZXJ5U2VsZWN0b3IiLCJ0b2dnbGVUb2RvQWRkRm9ybSIsInRvZ2dsZSIsImFwcGVuZFByb2plY3QiLCJwcm9qZWN0IiwicHJvamVjdERPTSIsInByb2plY3ROYW1lIiwiX2NyZWF0ZVByb2plY3QiLCJzZXRBY3RpdmVQcm9qZWN0IiwiYWN0aXZlUHJvamVjdCIsInJlbW92ZSIsImlubmVySFRNTCIsIl9yZW1vdmVBY3RpdmVQcm9qZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0b2RvcyIsImZvckVhY2giLCJfc2hvd1Byb2plY3RUb2RvcyIsInNob3dFZGl0Rm9ybSIsImRhdGFzZXQiLCJ0b2RvRm9ybSIsImNsb25lTm9kZSIsInJlc2V0IiwiX2Nsb25lVG9kb0Zvcm0iLCJ2YWx1ZSIsInZhbHVlQXNEYXRlIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiZWRpdFRvZG8iLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic2xpY2UiLCJkaXNwbGF5Q29udHJvbGxlciIsInNldEFjdGl2ZSIsImFkZFRvZG8iLCJwdXNoIiwicmVtb3ZlVG9kbyIsImluZGV4Iiwic3BsaWNlIiwiZ2V0VG9kbyIsImZpbmQiLCJzdGF0aWMiLCJhY3RpdmUiLCJUb2RvIiwiY2hlY2tlZCIsImVkaXQiLCJwcm9qZWN0MSIsInRvZG8xMSIsIkRhdGUiLCJ0b2RvMTIiLCJpbml0UGFnZSIsImFkZFRhc2siLCJ0b2Rvc0NvbnRhaW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInQiLCJ0YXJnZXQiLCJjbG9zZXN0Iiwib25jZSJdLCJzb3VyY2VSb290IjoiIn0=