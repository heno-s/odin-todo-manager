(()=>{"use strict";function e(e){const t=function(e){const{title:t,description:d,priority:o,dueDate:i,id:s}=e,c=document.createElement("div");c.classList.add("todo");const n=document.createElement("input");switch(n.type="checkbox",n.classList.add("priority"),+o){case 0:default:n.classList.add("priority-low");break;case 1:n.classList.add("priority-medium");break;case 2:n.classList.add("priority-high")}const r=document.createElement("div");r.classList.add("todo-body");const a=document.createElement("div");if(a.classList.add("todo-title"),a.textContent=t,r.appendChild(a),d){const e=document.createElement("div");e.classList.add("todo-description"),e.textContent=d.substr(0,50)+(d.length>50?"...":""),r.appendChild(e)}if(i){const e=document.createElement("div");e.classList.add("todo-due-date");const t=document.createElement("div");t.classList.add("mdi"),t.classList.add("mdi-calendar-clock-outline");const d=document.createElement("div");d.classList.add("todo-date"),d.textContent=i,e.appendChild(t),e.appendChild(d),r.appendChild(e)}const l=document.createElement("div");return l.classList.add("mdi"),l.classList.add("mdi-trash-can-outline"),c.appendChild(n),c.appendChild(r),c.appendChild(l),c.id=s,c}(e);document.querySelector(".todos").appendChild(t)}const t={toggleTodoAddForm:function(){document.querySelector(".add-task").classList.toggle("hide");const e=document.querySelector("#todo-form");e.reset(),e.classList.toggle("hide")},appendProject:function(e){const t=function(e){const{title:t,id:d}=e,o=document.createElement("li");o.classList.add("project"),o.id=d;const i=document.createElement("span");i.classList.add("project-name"),i.textContent=t;const s=document.createElement("div");return s.classList.add("mdi"),s.classList.add("mdi-trash-can-outline"),o.appendChild(i),o.appendChild(s),o}(e);document.querySelector(".projects").appendChild(t)},setActiveProject:function(t){!function(){const e=document.querySelector(".project.active");e&&(e.classList.remove(".ative"),document.querySelector(".todos").innerHTML="")}(),document.getElementById(t.id).classList.add("active"),function(t){t.todos.forEach(e)}(t)},appendTodo:e,createEditForm:function(e){if(document.querySelector(".todo-form").dataset.id)return null;const{title:t,description:d,priority:o,dueDate:i,id:s}=e,c=document.getElementById(e.id),n=function(){const e=document.querySelector("#todo-form").cloneNode(!0);return e.id="edit-form",e.reset(),e.classList.remove("hide"),e}();return n.dataset.id=s,n.title.value=t,n.description.value=d,n.priority.value=o,i&&(n.dueDate.valueAsDate=i),n.addEventListener("submit",(t=>{t.preventDefault();const[d,o,i,s]=[n.title.value,n.description.value,n.priority.value,n.dueDate.valueAsDate];e.edit(d,o,i,s)}),{once:!0}),n.querySelector(".close-form").addEventListener("click",(e=>{n.remove(),c.classList.remove("hide")}),{once:!0}),c.insertAdjacentElement("afterend",n),c.classList.add("hide"),n},editTodo:function(e){const{title:t,description:d,priority:o,id:i,dueDate:s}=e,c=document.getElementById(i),n=c.querySelector(".todo-body"),r=document.querySelector("#edit-form");c.querySelector(".todo-title").textContent=t,c.querySelector(".priority").value=o;let a=c.querySelector(".todo-description"),l=c.querySelector(".todo-due-date");if(d?(a||(a=document.createElement("div"),a.classList.add("todo-description"),n.appendChild(d)),a.textContent=d.substr(0,50)+(d.length>50?"...":"")):a&&a.remove(),s){if(!l){l=document.createElement("div"),l.classList.add("todo-due-date");const e=document.createElement("div");e.classList.add("mdi"),e.classList.add("mdi-calendar-clock-outline");const t=document.createElement("div");t.classList.add("todo-date"),t.textContent=s,l.appendChild(e),l.appendChild(t)}l.querySelector(".todo-date").textContent=s}else l&&l.remove();return c.classList.remove("hide"),r&&r.remove(),!0},removeTodo:function(e){document.getElementById(e).remove()}};class d{#e=[];#t=0;constructor(e){this.title=e,this.#t="id"+Math.random().toString(16).slice(2),t.appendProject(this),d.setActive(this)}addTodo(e){this.#e.push(e),t.appendTodo(e)}removeTodo(e){this.#e.splice(this.#e.findIndex((t=>t.id===e)),1),t.removeTodo(e)}getTodo(e){return this.#e.find((t=>t.id===e))}get id(){return this.#t}static setActive(e){d.#d=e,t.setActiveProject(e)}get todos(){return[...this.#e]}static#d;static get active(){return d.#d}}class o{checked=!1;#t=null;#o=null;constructor(e,t,o,i){this.title=e,this.description=t,this.priority=o,this.dueDate=i,this.#t="id"+Math.random().toString(16).slice(2),this.#o=d.active}edit(e,d,o,i){this.title=e,this.description=d,this.priority=o,this.dueDate=i,t.editTodo(this)}delete(){this.#o.removeTodo(this.#t)}get id(){return this.#t}}!function(){const e=new d("Today"),t=new o("Go out with trash","this is some randome not so short description",1,new Date),i=new o("Go shopping","this is some randome longer description about how awesome is this todo",0,new Date);e.addTodo(t),e.addTodo(i),[].push(e)}();const i=document.querySelector(".add-task"),s=document.querySelector(".todo-form"),c=document.querySelector(".todos");i.addEventListener("click",t.toggleTodoAddForm),s.querySelector(".close-form").addEventListener("click",t.toggleTodoAddForm),s.addEventListener("submit",(e=>{e.preventDefault();const[i,c,n,r]=[s.title.value,s.description.value,s.priority.value,s.dueDate.value],a=new o(i,c,n,r);d.active.addTodo(a),s.reset(),t.toggleTodoAddForm()})),c.addEventListener("click",(e=>{const o=e.target,i=o.closest(".todo"),s=d.active.getTodo(i.id);if(!i)return null;"checkbox"===o.type&&(s.checked=o.checked),o.closest(".todo-body")&&t.createEditForm(s),o.classList.contains("mdi-trash-can-outline")&&s.delete()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxFQUFRZ0IsT0FBT1AsUUFBUXZFLEdBQ3ZCNEIsRUFBU0MsUUFDVHdDLEVBQWtCM0MsbUJBQW1CLElBR3pDOEQsRUFBZXJDLGlCQUFpQixTQUFVQyxJQUN0QyxNQUFNcUMsRUFBSXJDLEVBQUlzQyxPQUNSekYsRUFBVXdGLEVBQUVFLFFBQVEsU0FDcEIzRixFQUFPOEQsRUFBUWdCLE9BQU9ILFFBQVExRSxFQUFRSyxJQUM1QyxJQUFLTCxFQUNELE9BQU8sS0FHSSxhQUFYd0YsRUFBRTdFLE9BQ0ZaLEVBQUtnRixRQUFVUyxFQUFFVCxTQUVqQlMsRUFBRUUsUUFBUSxlQUNWdEIsRUFBa0J6QixlQUFlNUMsR0FFakN5RixFQUFFaEYsVUFBVW1GLFNBQVMsMEJBQ3JCNUYsRUFBS2lGLFFBQ1QsRyIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL2Rpc3BsYXlDb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLW1hbmFnZXIvLi9zcmMvdG9kby5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9sb2FkSW5pdC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBhcHBlbmRQcm9qZWN0KHByb2plY3QpIHtcbiAgICBjb25zdCBwcm9qZWN0RE9NID0gX2NyZWF0ZVByb2plY3QocHJvamVjdCk7XG4gICAgY29uc3QgcHJvamVjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3RzXCIpO1xuICAgIHByb2plY3RzLmFwcGVuZENoaWxkKHByb2plY3RET00pO1xufVxuXG5mdW5jdGlvbiBfY3JlYXRlUHJvamVjdChwcm9qZWN0KSB7XG4gICAgY29uc3QgeyB0aXRsZSwgaWQgfSA9IHByb2plY3Q7XG4gICAgY29uc3QgcHJvamVjdERPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgICBwcm9qZWN0RE9NLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0XCIpO1xuICAgIHByb2plY3RET00uaWQgPSBpZDtcblxuICAgIGNvbnN0IHByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgcHJvamVjdE5hbWUuY2xhc3NMaXN0LmFkZChcInByb2plY3QtbmFtZVwiKTtcbiAgICBwcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9IHRpdGxlO1xuXG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKFwibWRpXCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaS10cmFzaC1jYW4tb3V0bGluZVwiKTtcblxuICAgIHByb2plY3RET00uYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuICAgIHByb2plY3RET00uYXBwZW5kQ2hpbGQoZGVsZXRlSWNvbik7XG5cbiAgICByZXR1cm4gcHJvamVjdERPTTtcbn1cblxuZnVuY3Rpb24gc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0KSB7XG4gICAgX3JlbW92ZUFjdGl2ZVByb2plY3QoKTtcbiAgICBjb25zdCBwcm9qZWN0RE9NID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocHJvamVjdC5pZCk7XG4gICAgcHJvamVjdERPTS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIF9zaG93UHJvamVjdFRvZG9zKHByb2plY3QpO1xufVxuXG5mdW5jdGlvbiBfcmVtb3ZlQWN0aXZlUHJvamVjdCgpIHtcbiAgICBjb25zdCBhY3RpdmVQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LmFjdGl2ZVwiKTtcbiAgICBpZiAoIWFjdGl2ZVByb2plY3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhY3RpdmVQcm9qZWN0LmNsYXNzTGlzdC5yZW1vdmUoXCIuYXRpdmVcIik7XG4gICAgX3JlbW92ZUN1cnJlbnRUb2RvcygpO1xufVxuXG5mdW5jdGlvbiBfcmVtb3ZlQ3VycmVudFRvZG9zKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmZ1bmN0aW9uIF9zaG93UHJvamVjdFRvZG9zKHByb2plY3QpIHtcbiAgICBjb25zdCB0b2RvcyA9IHByb2plY3QudG9kb3M7XG4gICAgdG9kb3MuZm9yRWFjaChhcHBlbmRUb2RvKTtcbn1cblxuZnVuY3Rpb24gYXBwZW5kVG9kbyh0b2RvKSB7XG4gICAgY29uc3QgdG9kb0RPTSA9IF9jcmVhdGVUb2RvKHRvZG8pO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0RPTSk7XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVUb2RvKHRvZG8pIHtcbiAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUsIGlkIH0gPSB0b2RvO1xuICAgIGNvbnN0IHRvZG9ET00gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9ET00uY2xhc3NMaXN0LmFkZChcInRvZG9cIik7XG5cbiAgICBjb25zdCBwcmlvcml0eURPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBwcmlvcml0eURPTS50eXBlID0gXCJjaGVja2JveFwiO1xuICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eVwiKTtcblxuICAgIHN3aXRjaCAoK3ByaW9yaXR5KSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eS1sb3dcIik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcHJpb3JpdHlET00uY2xhc3NMaXN0LmFkZChcInByaW9yaXR5LW1lZGl1bVwiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eS1oaWdoXCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktbG93XCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY29uc3QgdG9kb0JvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9Cb2R5LmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWJvZHlcIik7XG5cbiAgICBjb25zdCB0b2RvVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9UaXRsZS5jbGFzc0xpc3QuYWRkKFwidG9kby10aXRsZVwiKTtcbiAgICB0b2RvVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcblxuICAgIHRvZG9Cb2R5LmFwcGVuZENoaWxkKHRvZG9UaXRsZSk7XG5cbiAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgY29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdG9kb0Rlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICB0b2RvRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgZGVzY3JpcHRpb24uc3Vic3RyKDAsIDUwKSArXG4gICAgICAgICAgICAoZGVzY3JpcHRpb24ubGVuZ3RoID4gNTAgPyBcIi4uLlwiIDogXCJcIik7XG5cbiAgICAgICAgdG9kb0JvZHkuYXBwZW5kQ2hpbGQodG9kb0Rlc2NyaXB0aW9uKTtcbiAgICB9XG4gICAgaWYgKGR1ZURhdGUpIHtcbiAgICAgICAgY29uc3QgdG9kb0R1ZURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0b2RvRHVlRGF0ZS5jbGFzc0xpc3QuYWRkKFwidG9kby1kdWUtZGF0ZVwiKTtcblxuICAgICAgICBjb25zdCBjYWxlbmRhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGlcIik7XG4gICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGktY2FsZW5kYXItY2xvY2stb3V0bGluZVwiKTtcblxuICAgICAgICBjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRvZG9EYXRlLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRhdGVcIik7XG4gICAgICAgIHRvZG9EYXRlLnRleHRDb250ZW50ID0gZHVlRGF0ZTtcblxuICAgICAgICB0b2RvRHVlRGF0ZS5hcHBlbmRDaGlsZChjYWxlbmRhcik7XG4gICAgICAgIHRvZG9EdWVEYXRlLmFwcGVuZENoaWxkKHRvZG9EYXRlKTtcblxuICAgICAgICB0b2RvQm9keS5hcHBlbmRDaGlsZCh0b2RvRHVlRGF0ZSk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKFwibWRpXCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaS10cmFzaC1jYW4tb3V0bGluZVwiKTtcblxuICAgIHRvZG9ET00uYXBwZW5kQ2hpbGQocHJpb3JpdHlET00pO1xuICAgIHRvZG9ET00uYXBwZW5kQ2hpbGQodG9kb0JvZHkpO1xuICAgIHRvZG9ET00uYXBwZW5kQ2hpbGQoZGVsZXRlSWNvbik7XG5cbiAgICB0b2RvRE9NLmlkID0gaWQ7XG5cbiAgICByZXR1cm4gdG9kb0RPTTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlVG9kb0FkZEZvcm0oKSB7XG4gICAgY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG4gICAgYWRkVGFzay5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZVwiKTtcblxuICAgIGNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLWZvcm1cIik7XG4gICAgdG9kb0Zvcm0ucmVzZXQoKTtcbiAgICB0b2RvRm9ybS5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZVwiKTtcbn1cblxuZnVuY3Rpb24gX2Nsb25lVG9kb0Zvcm0oKSB7XG4gICAgY29uc3QgdG9kb0Zvcm0gPSBkb2N1bWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIiN0b2RvLWZvcm1cIilcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0b2RvRm9ybS5pZCA9IFwiZWRpdC1mb3JtXCI7XG4gICAgdG9kb0Zvcm0ucmVzZXQoKTtcbiAgICB0b2RvRm9ybS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcblxuICAgIHJldHVybiB0b2RvRm9ybTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRWRpdEZvcm0odG9kbykge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZm9ybVwiKS5kYXRhc2V0LmlkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUsIGlkIH0gPSB0b2RvO1xuICAgIGNvbnN0IHRvZG9ET00gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0b2RvLmlkKTtcbiAgICBjb25zdCBlZGl0Rm9ybSA9IF9jbG9uZVRvZG9Gb3JtKCk7XG5cbiAgICBlZGl0Rm9ybS5kYXRhc2V0LmlkID0gaWQ7XG4gICAgZWRpdEZvcm0udGl0bGUudmFsdWUgPSB0aXRsZTtcbiAgICBlZGl0Rm9ybS5kZXNjcmlwdGlvbi52YWx1ZSA9IGRlc2NyaXB0aW9uO1xuICAgIGVkaXRGb3JtLnByaW9yaXR5LnZhbHVlID0gcHJpb3JpdHk7XG4gICAgaWYgKGR1ZURhdGUpIHtcbiAgICAgICAgZWRpdEZvcm0uZHVlRGF0ZS52YWx1ZUFzRGF0ZSA9IGR1ZURhdGU7XG4gICAgfVxuXG4gICAgZWRpdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJzdWJtaXRcIixcbiAgICAgICAgKGV2dCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZV0gPSBbXG4gICAgICAgICAgICAgICAgZWRpdEZvcm0udGl0bGUudmFsdWUsXG4gICAgICAgICAgICAgICAgZWRpdEZvcm0uZGVzY3JpcHRpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgZWRpdEZvcm0ucHJpb3JpdHkudmFsdWUsXG4gICAgICAgICAgICAgICAgZWRpdEZvcm0uZHVlRGF0ZS52YWx1ZUFzRGF0ZSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICB0b2RvLmVkaXQodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgKTtcblxuICAgIGVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuY2xvc2UtZm9ybVwiKS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcImNsaWNrXCIsXG4gICAgICAgIChlKSA9PiB7XG4gICAgICAgICAgICBlZGl0Rm9ybS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRvZG9ET00uY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgICAgIH0sXG4gICAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgKTtcblxuICAgIHRvZG9ET00uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYWZ0ZXJlbmRcIiwgZWRpdEZvcm0pO1xuICAgIHRvZG9ET00uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG5cbiAgICByZXR1cm4gZWRpdEZvcm07XG59XG5cbmZ1bmN0aW9uIGVkaXRUb2RvKHRvZG8pIHtcbiAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGlkLCBkdWVEYXRlIH0gPSB0b2RvO1xuXG4gICAgY29uc3QgdG9kb0RPTSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBjb25zdCB0b2RvQm9keSA9IHRvZG9ET00ucXVlcnlTZWxlY3RvcihcIi50b2RvLWJvZHlcIik7XG4gICAgY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtZm9ybVwiKTtcblxuICAgIHRvZG9ET00ucXVlcnlTZWxlY3RvcihcIi50b2RvLXRpdGxlXCIpLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgdG9kb0RPTS5xdWVyeVNlbGVjdG9yKFwiLnByaW9yaXR5XCIpLnZhbHVlID0gcHJpb3JpdHk7XG4gICAgbGV0IGRlc2NyaXB0aW9uRE9NID0gdG9kb0RPTS5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZGVzY3JpcHRpb25cIik7XG4gICAgbGV0IGRhdGVET00gPSB0b2RvRE9NLnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1kdWUtZGF0ZVwiKTtcblxuICAgIGlmICghZGVzY3JpcHRpb24pIHtcbiAgICAgICAgZGVzY3JpcHRpb25ET00gJiYgZGVzY3JpcHRpb25ET00ucmVtb3ZlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFkZXNjcmlwdGlvbkRPTSkge1xuICAgICAgICAgICAgZGVzY3JpcHRpb25ET00gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgZGVzY3JpcHRpb25ET00uY2xhc3NMaXN0LmFkZChcInRvZG8tZGVzY3JpcHRpb25cIik7XG4gICAgICAgICAgICB0b2RvQm9keS5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBkZXNjcmlwdGlvbkRPTS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbi5zdWJzdHIoMCwgNTApICtcbiAgICAgICAgICAgIChkZXNjcmlwdGlvbi5sZW5ndGggPiA1MCA/IFwiLi4uXCIgOiBcIlwiKTtcbiAgICB9XG5cbiAgICBpZiAoIWR1ZURhdGUpIHtcbiAgICAgICAgZGF0ZURPTSAmJiBkYXRlRE9NLnJlbW92ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghZGF0ZURPTSkge1xuICAgICAgICAgICAgZGF0ZURPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBkYXRlRE9NLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWR1ZS1kYXRlXCIpO1xuICAgICAgICAgICAgY29uc3QgY2FsZW5kYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgY2FsZW5kYXIuY2xhc3NMaXN0LmFkZChcIm1kaVwiKTtcbiAgICAgICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGktY2FsZW5kYXItY2xvY2stb3V0bGluZVwiKTtcblxuICAgICAgICAgICAgY29uc3QgdG9kb0RhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdG9kb0RhdGUuY2xhc3NMaXN0LmFkZChcInRvZG8tZGF0ZVwiKTtcbiAgICAgICAgICAgIHRvZG9EYXRlLnRleHRDb250ZW50ID0gZHVlRGF0ZTtcblxuICAgICAgICAgICAgZGF0ZURPTS5hcHBlbmRDaGlsZChjYWxlbmRhcik7XG4gICAgICAgICAgICBkYXRlRE9NLmFwcGVuZENoaWxkKHRvZG9EYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRlRE9NLnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1kYXRlXCIpLnRleHRDb250ZW50ID0gZHVlRGF0ZTtcbiAgICB9XG5cbiAgICB0b2RvRE9NLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgIGVkaXRGb3JtICYmIGVkaXRGb3JtLnJlbW92ZSgpO1xuICAgIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiByZW1vdmVUb2RvKGlkKSB7XG4gICAgY29uc3QgdG9kbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICB0b2RvLnJlbW92ZSgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgdG9nZ2xlVG9kb0FkZEZvcm0sXG4gICAgYXBwZW5kUHJvamVjdCxcbiAgICBzZXRBY3RpdmVQcm9qZWN0LFxuICAgIGFwcGVuZFRvZG8sXG4gICAgY3JlYXRlRWRpdEZvcm0sXG4gICAgZWRpdFRvZG8sXG4gICAgcmVtb3ZlVG9kbyxcbn07XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXIuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvamVjdCB7XG4gICAgI3RvZG9zID0gW107XG4gICAgI2lkID0gMDtcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuI2lkID0gXCJpZFwiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMik7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmFwcGVuZFByb2plY3QodGhpcyk7XG4gICAgICAgIFByb2plY3Quc2V0QWN0aXZlKHRoaXMpO1xuICAgIH1cblxuICAgIGFkZFRvZG8odG9kbykge1xuICAgICAgICB0aGlzLiN0b2Rvcy5wdXNoKHRvZG8pO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5hcHBlbmRUb2RvKHRvZG8pO1xuICAgIH1cblxuICAgIHJlbW92ZVRvZG8oaWQpIHtcbiAgICAgICAgdGhpcy4jdG9kb3Muc3BsaWNlKFxuICAgICAgICAgICAgdGhpcy4jdG9kb3MuZmluZEluZGV4KCh0b2RvKSA9PiB0b2RvLmlkID09PSBpZCksXG4gICAgICAgICAgICAxXG4gICAgICAgICk7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLnJlbW92ZVRvZG8oaWQpO1xuICAgIH1cblxuICAgIGdldFRvZG8oaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI3RvZG9zLmZpbmQoKHRvZG8pID0+IHRvZG8uaWQgPT09IGlkKTtcbiAgICB9XG5cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNpZDtcbiAgICB9XG5cbiAgICBzdGF0aWMgc2V0QWN0aXZlKHByb2plY3QpIHtcbiAgICAgICAgUHJvamVjdC4jYWN0aXZlID0gcHJvamVjdDtcbiAgICAgICAgZGlzcGxheUNvbnRyb2xsZXIuc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0KTtcbiAgICB9XG5cbiAgICBnZXQgdG9kb3MoKSB7XG4gICAgICAgIHJldHVybiBbLi4udGhpcy4jdG9kb3NdO1xuICAgIH1cblxuICAgIHN0YXRpYyAjYWN0aXZlO1xuICAgIHN0YXRpYyBnZXQgYWN0aXZlKCkge1xuICAgICAgICByZXR1cm4gUHJvamVjdC4jYWN0aXZlO1xuICAgIH1cbn1cbiIsImltcG9ydCBkaXNwbGF5Q29udHJvbGxlciBmcm9tIFwiLi9kaXNwbGF5Q29udHJvbGxlclwiO1xuaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb2RvIHtcbiAgICBjaGVja2VkID0gZmFsc2U7XG4gICAgI2lkID0gbnVsbDtcbiAgICAjcHJvamVjdCA9IG51bGw7XG4gICAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xuICAgICAgICB0aGlzLiNpZCA9IFwiaWRcIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIpO1xuICAgICAgICB0aGlzLiNwcm9qZWN0ID0gUHJvamVjdC5hY3RpdmU7XG4gICAgfVxuXG4gICAgZWRpdCh0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgICAgIHRoaXMuZHVlRGF0ZSA9IGR1ZURhdGU7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmVkaXRUb2RvKHRoaXMpO1xuICAgIH1cblxuICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgdGhpcy4jcHJvamVjdC5yZW1vdmVUb2RvKHRoaXMuI2lkKTtcbiAgICB9XG5cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNpZDtcbiAgICB9XG59XG4iLCJpbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9wcm9qZWN0XCI7XG5pbXBvcnQgVG9kbyBmcm9tIFwiLi90b2RvXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGluaXRQYWdlKCkge1xuICAgIGNvbnN0IHByb2plY3RzID0gW107XG5cbiAgICBjb25zdCBwcm9qZWN0MSA9IG5ldyBQcm9qZWN0KFwiVG9kYXlcIik7XG5cbiAgICBjb25zdCB0b2RvMTEgPSBuZXcgVG9kbyhcbiAgICAgICAgXCJHbyBvdXQgd2l0aCB0cmFzaFwiLFxuICAgICAgICBcInRoaXMgaXMgc29tZSByYW5kb21lIG5vdCBzbyBzaG9ydCBkZXNjcmlwdGlvblwiLFxuICAgICAgICAxLFxuICAgICAgICBuZXcgRGF0ZSgpXG4gICAgKTtcbiAgICBjb25zdCB0b2RvMTIgPSBuZXcgVG9kbyhcbiAgICAgICAgXCJHbyBzaG9wcGluZ1wiLFxuICAgICAgICBcInRoaXMgaXMgc29tZSByYW5kb21lIGxvbmdlciBkZXNjcmlwdGlvbiBhYm91dCBob3cgYXdlc29tZSBpcyB0aGlzIHRvZG9cIixcbiAgICAgICAgMCxcbiAgICAgICAgbmV3IERhdGUoKVxuICAgICk7XG5cbiAgICBwcm9qZWN0MS5hZGRUb2RvKHRvZG8xMSk7XG4gICAgcHJvamVjdDEuYWRkVG9kbyh0b2RvMTIpO1xuXG4gICAgcHJvamVjdHMucHVzaChwcm9qZWN0MSk7XG59XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXJcIjtcbmltcG9ydCBpbml0UGFnZSBmcm9tIFwiLi9sb2FkSW5pdFwiO1xuaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IFRvZG8gZnJvbSBcIi4vdG9kb1wiO1xuXG5pbml0UGFnZSgpO1xuXG4vKiBFTEVNRU5UUyAqL1xuY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG5jb25zdCB0b2RvRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1mb3JtXCIpO1xuY29uc3QgdG9kb3NDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG9zXCIpO1xuXG4vKiBMSVNURU5FUlMgKi9cbmFkZFRhc2suYWRkRXZlbnRMaXN0ZW5lcihcbiAgICBcImNsaWNrXCIsXG4gICAgZGlzcGxheUNvbnRyb2xsZXIudG9nZ2xlVG9kb0FkZEZvcm1cbik7XG5cbnRvZG9Gb3JtXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2xvc2UtZm9ybVwiKVxuICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZGlzcGxheUNvbnRyb2xsZXIudG9nZ2xlVG9kb0FkZEZvcm0pO1xuXG50b2RvRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZV0gPSBbXG4gICAgICAgIHRvZG9Gb3JtLnRpdGxlLnZhbHVlLFxuICAgICAgICB0b2RvRm9ybS5kZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgICAgdG9kb0Zvcm0ucHJpb3JpdHkudmFsdWUsXG4gICAgICAgIHRvZG9Gb3JtLmR1ZURhdGUudmFsdWUsXG4gICAgXTtcblxuICAgIGNvbnN0IHRvZG8gPSBuZXcgVG9kbyh0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKTtcbiAgICBQcm9qZWN0LmFjdGl2ZS5hZGRUb2RvKHRvZG8pO1xuICAgIHRvZG9Gb3JtLnJlc2V0KCk7XG4gICAgZGlzcGxheUNvbnRyb2xsZXIudG9nZ2xlVG9kb0FkZEZvcm0oKTtcbn0pO1xuXG50b2Rvc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGNvbnN0IHQgPSBldnQudGFyZ2V0O1xuICAgIGNvbnN0IHRvZG9ET00gPSB0LmNsb3Nlc3QoXCIudG9kb1wiKTtcbiAgICBjb25zdCB0b2RvID0gUHJvamVjdC5hY3RpdmUuZ2V0VG9kbyh0b2RvRE9NLmlkKTtcbiAgICBpZiAoIXRvZG9ET00pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHQudHlwZSA9PT0gXCJjaGVja2JveFwiKSB7XG4gICAgICAgIHRvZG8uY2hlY2tlZCA9IHQuY2hlY2tlZDtcbiAgICB9XG4gICAgaWYgKHQuY2xvc2VzdChcIi50b2RvLWJvZHlcIikpIHtcbiAgICAgICAgZGlzcGxheUNvbnRyb2xsZXIuY3JlYXRlRWRpdEZvcm0odG9kbyk7XG4gICAgfVxuICAgIGlmICh0LmNsYXNzTGlzdC5jb250YWlucyhcIm1kaS10cmFzaC1jYW4tb3V0bGluZVwiKSkge1xuICAgICAgICB0b2RvLmRlbGV0ZSgpO1xuICAgIH1cbn0pO1xuIl0sIm5hbWVzIjpbImFwcGVuZFRvZG8iLCJ0b2RvIiwidG9kb0RPTSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsImR1ZURhdGUiLCJpZCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInByaW9yaXR5RE9NIiwidHlwZSIsInRvZG9Cb2R5IiwidG9kb1RpdGxlIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsInRvZG9EZXNjcmlwdGlvbiIsInN1YnN0ciIsImxlbmd0aCIsInRvZG9EdWVEYXRlIiwiY2FsZW5kYXIiLCJ0b2RvRGF0ZSIsImRlbGV0ZUljb24iLCJfY3JlYXRlVG9kbyIsInF1ZXJ5U2VsZWN0b3IiLCJ0b2dnbGVUb2RvQWRkRm9ybSIsInRvZ2dsZSIsInRvZG9Gb3JtIiwicmVzZXQiLCJhcHBlbmRQcm9qZWN0IiwicHJvamVjdCIsInByb2plY3RET00iLCJwcm9qZWN0TmFtZSIsIl9jcmVhdGVQcm9qZWN0Iiwic2V0QWN0aXZlUHJvamVjdCIsImFjdGl2ZVByb2plY3QiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJfcmVtb3ZlQWN0aXZlUHJvamVjdCIsImdldEVsZW1lbnRCeUlkIiwidG9kb3MiLCJmb3JFYWNoIiwiX3Nob3dQcm9qZWN0VG9kb3MiLCJjcmVhdGVFZGl0Rm9ybSIsImRhdGFzZXQiLCJlZGl0Rm9ybSIsImNsb25lTm9kZSIsIl9jbG9uZVRvZG9Gb3JtIiwidmFsdWUiLCJ2YWx1ZUFzRGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVkaXQiLCJvbmNlIiwiZSIsImluc2VydEFkamFjZW50RWxlbWVudCIsImVkaXRUb2RvIiwiZGVzY3JpcHRpb25ET00iLCJkYXRlRE9NIiwicmVtb3ZlVG9kbyIsIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzbGljZSIsImRpc3BsYXlDb250cm9sbGVyIiwic2V0QWN0aXZlIiwiYWRkVG9kbyIsInB1c2giLCJzcGxpY2UiLCJmaW5kSW5kZXgiLCJnZXRUb2RvIiwiZmluZCIsInN0YXRpYyIsImFjdGl2ZSIsIlRvZG8iLCJjaGVja2VkIiwiZGVsZXRlIiwicHJvamVjdDEiLCJ0b2RvMTEiLCJEYXRlIiwidG9kbzEyIiwiaW5pdFBhZ2UiLCJhZGRUYXNrIiwidG9kb3NDb250YWluZXIiLCJ0IiwidGFyZ2V0IiwiY2xvc2VzdCIsImNvbnRhaW5zIl0sInNvdXJjZVJvb3QiOiIifQ==