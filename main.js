(()=>{"use strict";function t(t){const e=function(t){const{title:e,description:o,priority:d,dueDate:i,id:s}=t,n=document.createElement("div");n.classList.add("todo");const c=document.createElement("input");switch(c.type="checkbox",c.classList.add("priority"),+d){case 0:default:c.classList.add("priority-low");break;case 1:c.classList.add("priority-medium");break;case 2:c.classList.add("priority-high")}const r=document.createElement("div");r.classList.add("todo-body");const a=document.createElement("div");if(a.classList.add("todo-title"),a.textContent=e,r.appendChild(a),o){const t=document.createElement("div");t.classList.add("todo-description"),t.textContent=o.substr(0,50)+(o.length>50?"...":""),r.appendChild(t)}if(i){const t=document.createElement("div");t.classList.add("todo-due-date");const e=document.createElement("div");e.classList.add("mdi"),e.classList.add("mdi-calendar-clock-outline");const o=document.createElement("div");o.classList.add("todo-date"),o.textContent=i,t.appendChild(e),t.appendChild(o),r.appendChild(t)}const l=document.createElement("div");return l.classList.add("mdi"),l.classList.add("mdi-trash-can-outline"),n.appendChild(c),n.appendChild(r),n.appendChild(l),n.id=s,n}(t);document.querySelector(".todos").appendChild(e)}const e={toggleTodoAddForm:function(){document.querySelector(".add-task").classList.toggle("hide"),document.querySelector(".todo-form").classList.toggle("hide")},appendProject:function(t){const e=function(t){const{title:e,id:o}=t,d=document.createElement("li");d.classList.add("project"),d.id=o;const i=document.createElement("span");i.classList.add("project-name"),i.textContent=e;const s=document.createElement("div");return s.classList.add("mdi"),s.classList.add("mdi-trash-can-outline"),d.appendChild(i),d.appendChild(s),d}(t);document.querySelector(".projects").appendChild(e)},setActiveProject:function(e){!function(){const t=document.querySelector(".project.active");t&&(t.classList.remove(".ative"),document.querySelector(".todos").innerHTML="")}(),document.getElementById(e.id).classList.add("active"),function(e){e.todos.forEach(t)}(e)},appendTodo:t,showEditForm:function(t){if(document.querySelector(".todo-form").dataset.id)return null;const{title:e,description:o,priority:d,dueDate:i,id:s}=t,n=document.getElementById(t.id),c=function(){const t=document.querySelector(".todo-form").cloneNode(!0);return t.reset(),t.classList.remove("hide"),t}();return c.dataset.id=s,c.title.value=e,c.description.value=o,c.priority.value=d,c.dueDate.valueAsDate=i,n.insertAdjacentElement("afterend",c),n.classList.add("hide"),c},editTodo:function(t){const{title:e,description:o,priority:d,id:i,dueDate:s}=t,n=document.getElementById(i),c=document.querySelector(".todos .todo-form");return n.querySelector(".todo-title").textContent=e,n.querySelector(".todo-description").textContent=o.substr(0,50)+(o.length>50?"...":""),n.querySelector(".priority").value=d,n.querySelector(".todo-date").valueAsDate=s,c.remove(),n.classList.remove("hide"),!0},removeTodo:function(t){document.getElementById(t).remove()}};class o{#t=[];#e=0;constructor(t){this.title=t,this.#e="id"+Math.random().toString(16).slice(2),e.appendProject(this),o.setActive(this)}addTodo(t){this.#t.push(t),e.appendTodo(t)}removeTodo(t){this.#t.splice(this.#t.findIndex((e=>e.id===t)),1),e.removeTodo(t)}getTodo(t){return this.#t.find((e=>e.id===t))}get id(){return this.#e}static setActive(t){o.#o=t,e.setActiveProject(t)}get todos(){return[...this.#t]}static#o;static get active(){return o.#o}}class d{checked=!1;#e=null;#d=null;constructor(t,e,d,i){this.title=t,this.description=e,this.priority=d,this.dueDate=i,this.#e="id"+Math.random().toString(16).slice(2),this.#d=o.active}edit(t,o,d,i){this.title=t,this.description=o,this.priority=d,this.dueDate=i,e.editTodo(this)}delete(){this.#d.removeTodo(this.#e)}get id(){return this.#e}}!function(){const t=new o("Today"),e=new d("Go out with trash","this is some randome not so short description",1,new Date),i=new d("Go shopping","this is some randome longer description about how awesome is this todo",0,new Date);t.addTodo(e),t.addTodo(i),[].push(t)}();const i=document.querySelector(".add-task"),s=document.querySelector(".todo-form"),n=document.querySelector(".todos");i.addEventListener("click",(t=>{e.toggleTodoAddForm()})),s.addEventListener("submit",(t=>{t.preventDefault();const[i,n,c,r]=[s.title.value,s.description.value,s.priority.value,s.dueDate.value],a=new d(i,n,c,r);o.active.addTodo(a),s.reset(),e.toggleTodoAddForm()})),n.addEventListener("click",(t=>{const d=t.target,i=d.closest(".todo"),s=o.active.getTodo(i.id);if(!i)return null;if("checkbox"===d.type&&(s.checked=d.checked),d.closest(".todo-body")){const t=e.showEditForm(s);if(null===t)return null;t.addEventListener("submit",(e=>{e.preventDefault();const[o,d,i,n]=[t.title.value,t.description.value,t.priority.value,t.dueDate.valueAsDate];s.edit(o,d,i,n)}),{once:!0})}d.classList.contains("mdi-trash-can-outline")&&s.delete()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFROUQsR0FDdkI0QyxFQUFTRSxRQUNUYyxFQUFrQmxDLG1CQUFtQixJQUd6Q3NELEVBQWVDLGlCQUFpQixTQUFVQyxJQUN0QyxNQUFNRSxFQUFJRixFQUFJRyxPQUNScEYsRUFBVW1GLEVBQUVFLFFBQVEsU0FDcEJ0RixFQUFPcUQsRUFBUWdCLE9BQU9ILFFBQVFqRSxFQUFRSyxJQUM1QyxJQUFLTCxFQUNELE9BQU8sS0FNWCxHQUhlLGFBQVhtRixFQUFFeEUsT0FDRlosRUFBS3VFLFFBQVVhLEVBQUViLFNBRWpCYSxFQUFFRSxRQUFRLGNBQWUsQ0FDekIsTUFBTTFDLEVBQVdnQixFQUFrQmxCLGFBQWExQyxHQUNoRCxHQUFpQixPQUFiNEMsRUFDQSxPQUFPLEtBR1hBLEVBQVNxQyxpQkFDTCxVQUNDQyxJQUNHQSxFQUFJQyxpQkFDSixNQUFPakYsRUFBT0MsRUFBYUMsRUFBVUMsR0FBVyxDQUM1Q3VDLEVBQVMxQyxNQUFNOEMsTUFDZkosRUFBU3pDLFlBQVk2QyxNQUNyQkosRUFBU3hDLFNBQVM0QyxNQUNsQkosRUFBU3ZDLFFBQVE0QyxhQUVyQmpELEVBQUt3RSxLQUFLdEUsRUFBT0MsRUFBYUMsRUFBVUMsRUFBUSxHQUVwRCxDQUFFa0YsTUFBTSxHQUVoQixDQUNJSCxFQUFFM0UsVUFBVStFLFNBQVMsMEJBQ3JCeEYsRUFBS3lFLFFBQ1QsRyIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL2Rpc3BsYXlDb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLW1hbmFnZXIvLi9zcmMvdG9kby5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9sb2FkSW5pdC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBhcHBlbmRQcm9qZWN0KHByb2plY3QpIHtcbiAgICBjb25zdCBwcm9qZWN0RE9NID0gX2NyZWF0ZVByb2plY3QocHJvamVjdCk7XG4gICAgY29uc3QgcHJvamVjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3RzXCIpO1xuICAgIHByb2plY3RzLmFwcGVuZENoaWxkKHByb2plY3RET00pO1xufVxuXG5mdW5jdGlvbiBfY3JlYXRlUHJvamVjdChwcm9qZWN0KSB7XG4gICAgY29uc3QgeyB0aXRsZSwgaWQgfSA9IHByb2plY3Q7XG4gICAgY29uc3QgcHJvamVjdERPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgICBwcm9qZWN0RE9NLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0XCIpO1xuICAgIHByb2plY3RET00uaWQgPSBpZDtcblxuICAgIGNvbnN0IHByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgcHJvamVjdE5hbWUuY2xhc3NMaXN0LmFkZChcInByb2plY3QtbmFtZVwiKTtcbiAgICBwcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9IHRpdGxlO1xuXG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKFwibWRpXCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaS10cmFzaC1jYW4tb3V0bGluZVwiKTtcblxuICAgIHByb2plY3RET00uYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuICAgIHByb2plY3RET00uYXBwZW5kQ2hpbGQoZGVsZXRlSWNvbik7XG5cbiAgICByZXR1cm4gcHJvamVjdERPTTtcbn1cblxuZnVuY3Rpb24gc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0KSB7XG4gICAgX3JlbW92ZUFjdGl2ZVByb2plY3QoKTtcbiAgICBjb25zdCBwcm9qZWN0RE9NID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocHJvamVjdC5pZCk7XG4gICAgcHJvamVjdERPTS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIF9zaG93UHJvamVjdFRvZG9zKHByb2plY3QpO1xufVxuXG5mdW5jdGlvbiBfcmVtb3ZlQWN0aXZlUHJvamVjdCgpIHtcbiAgICBjb25zdCBhY3RpdmVQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LmFjdGl2ZVwiKTtcbiAgICBpZiAoIWFjdGl2ZVByb2plY3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhY3RpdmVQcm9qZWN0LmNsYXNzTGlzdC5yZW1vdmUoXCIuYXRpdmVcIik7XG4gICAgX3JlbW92ZUN1cnJlbnRUb2RvcygpO1xufVxuXG5mdW5jdGlvbiBfcmVtb3ZlQ3VycmVudFRvZG9zKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmZ1bmN0aW9uIF9zaG93UHJvamVjdFRvZG9zKHByb2plY3QpIHtcbiAgICBjb25zdCB0b2RvcyA9IHByb2plY3QudG9kb3M7XG4gICAgdG9kb3MuZm9yRWFjaChhcHBlbmRUb2RvKTtcbn1cblxuZnVuY3Rpb24gYXBwZW5kVG9kbyh0b2RvKSB7XG4gICAgY29uc3QgdG9kb0RPTSA9IF9jcmVhdGVUb2RvKHRvZG8pO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0RPTSk7XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVUb2RvKHRvZG8pIHtcbiAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUsIGlkIH0gPSB0b2RvO1xuICAgIGNvbnN0IHRvZG9ET00gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9ET00uY2xhc3NMaXN0LmFkZChcInRvZG9cIik7XG5cbiAgICBjb25zdCBwcmlvcml0eURPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBwcmlvcml0eURPTS50eXBlID0gXCJjaGVja2JveFwiO1xuICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eVwiKTtcblxuICAgIHN3aXRjaCAoK3ByaW9yaXR5KSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eS1sb3dcIik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcHJpb3JpdHlET00uY2xhc3NMaXN0LmFkZChcInByaW9yaXR5LW1lZGl1bVwiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eS1oaWdoXCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktbG93XCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY29uc3QgdG9kb0JvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9Cb2R5LmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWJvZHlcIik7XG5cbiAgICBjb25zdCB0b2RvVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9UaXRsZS5jbGFzc0xpc3QuYWRkKFwidG9kby10aXRsZVwiKTtcbiAgICB0b2RvVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcblxuICAgIHRvZG9Cb2R5LmFwcGVuZENoaWxkKHRvZG9UaXRsZSk7XG5cbiAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgY29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdG9kb0Rlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICB0b2RvRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgZGVzY3JpcHRpb24uc3Vic3RyKDAsIDUwKSArXG4gICAgICAgICAgICAoZGVzY3JpcHRpb24ubGVuZ3RoID4gNTAgPyBcIi4uLlwiIDogXCJcIik7XG5cbiAgICAgICAgdG9kb0JvZHkuYXBwZW5kQ2hpbGQodG9kb0Rlc2NyaXB0aW9uKTtcbiAgICB9XG4gICAgaWYgKGR1ZURhdGUpIHtcbiAgICAgICAgY29uc3QgdG9kb0R1ZURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0b2RvRHVlRGF0ZS5jbGFzc0xpc3QuYWRkKFwidG9kby1kdWUtZGF0ZVwiKTtcblxuICAgICAgICBjb25zdCBjYWxlbmRhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGlcIik7XG4gICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGktY2FsZW5kYXItY2xvY2stb3V0bGluZVwiKTtcblxuICAgICAgICBjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRvZG9EYXRlLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRhdGVcIik7XG4gICAgICAgIHRvZG9EYXRlLnRleHRDb250ZW50ID0gZHVlRGF0ZTtcblxuICAgICAgICB0b2RvRHVlRGF0ZS5hcHBlbmRDaGlsZChjYWxlbmRhcik7XG4gICAgICAgIHRvZG9EdWVEYXRlLmFwcGVuZENoaWxkKHRvZG9EYXRlKTtcblxuICAgICAgICB0b2RvQm9keS5hcHBlbmRDaGlsZCh0b2RvRHVlRGF0ZSk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKFwibWRpXCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaS10cmFzaC1jYW4tb3V0bGluZVwiKTtcblxuICAgIHRvZG9ET00uYXBwZW5kQ2hpbGQocHJpb3JpdHlET00pO1xuICAgIHRvZG9ET00uYXBwZW5kQ2hpbGQodG9kb0JvZHkpO1xuICAgIHRvZG9ET00uYXBwZW5kQ2hpbGQoZGVsZXRlSWNvbik7XG5cbiAgICB0b2RvRE9NLmlkID0gaWQ7XG5cbiAgICByZXR1cm4gdG9kb0RPTTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlVG9kb0FkZEZvcm0oKSB7XG4gICAgY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG4gICAgYWRkVGFzay5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZVwiKTtcblxuICAgIGNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLWZvcm1cIik7XG4gICAgdG9kb0Zvcm0uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGVcIik7XG59XG5cbmZ1bmN0aW9uIF9jbG9uZVRvZG9Gb3JtKCkge1xuICAgIGNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1mb3JtXCIpXG4gICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgdG9kb0Zvcm0ucmVzZXQoKTtcbiAgICB0b2RvRm9ybS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcblxuICAgIHJldHVybiB0b2RvRm9ybTtcbn1cblxuZnVuY3Rpb24gc2hvd0VkaXRGb3JtKHRvZG8pIHtcbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLWZvcm1cIikuZGF0YXNldC5pZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyB0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlLCBpZCB9ID0gdG9kbztcbiAgICBjb25zdCB0b2RvRE9NID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodG9kby5pZCk7XG4gICAgY29uc3QgdG9kb0Zvcm0gPSBfY2xvbmVUb2RvRm9ybSgpO1xuXG4gICAgdG9kb0Zvcm0uZGF0YXNldC5pZCA9IGlkO1xuICAgIHRvZG9Gb3JtLnRpdGxlLnZhbHVlID0gdGl0bGU7XG4gICAgdG9kb0Zvcm0uZGVzY3JpcHRpb24udmFsdWUgPSBkZXNjcmlwdGlvbjtcbiAgICB0b2RvRm9ybS5wcmlvcml0eS52YWx1ZSA9IHByaW9yaXR5O1xuICAgIHRvZG9Gb3JtLmR1ZURhdGUudmFsdWVBc0RhdGUgPSBkdWVEYXRlO1xuXG4gICAgdG9kb0RPTS5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJhZnRlcmVuZFwiLCB0b2RvRm9ybSk7XG4gICAgdG9kb0RPTS5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcblxuICAgIHJldHVybiB0b2RvRm9ybTtcbn1cblxuZnVuY3Rpb24gZWRpdFRvZG8odG9kbykge1xuICAgIGNvbnN0IHsgdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgaWQsIGR1ZURhdGUgfSA9IHRvZG87XG5cbiAgICBjb25zdCB0b2RvRE9NID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIGNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvcyAudG9kby1mb3JtXCIpO1xuXG4gICAgdG9kb0RPTS5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB0b2RvRE9NLnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1kZXNjcmlwdGlvblwiKS50ZXh0Q29udGVudCA9XG4gICAgICAgIGRlc2NyaXB0aW9uLnN1YnN0cigwLCA1MCkgK1xuICAgICAgICAoZGVzY3JpcHRpb24ubGVuZ3RoID4gNTAgPyBcIi4uLlwiIDogXCJcIik7XG4gICAgdG9kb0RPTS5xdWVyeVNlbGVjdG9yKFwiLnByaW9yaXR5XCIpLnZhbHVlID0gcHJpb3JpdHk7XG4gICAgdG9kb0RPTS5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZGF0ZVwiKS52YWx1ZUFzRGF0ZSA9IGR1ZURhdGU7XG5cbiAgICB0b2RvRm9ybS5yZW1vdmUoKTtcbiAgICB0b2RvRE9NLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiByZW1vdmVUb2RvKGlkKSB7XG4gICAgY29uc3QgdG9kbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICB0b2RvLnJlbW92ZSgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgdG9nZ2xlVG9kb0FkZEZvcm0sXG4gICAgYXBwZW5kUHJvamVjdCxcbiAgICBzZXRBY3RpdmVQcm9qZWN0LFxuICAgIGFwcGVuZFRvZG8sXG4gICAgc2hvd0VkaXRGb3JtLFxuICAgIGVkaXRUb2RvLFxuICAgIHJlbW92ZVRvZG8sXG59O1xuIiwiaW1wb3J0IGRpc3BsYXlDb250cm9sbGVyIGZyb20gXCIuL2Rpc3BsYXlDb250cm9sbGVyLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3Qge1xuICAgICN0b2RvcyA9IFtdO1xuICAgICNpZCA9IDA7XG4gICAgY29uc3RydWN0b3IodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLiNpZCA9IFwiaWRcIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIpO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5hcHBlbmRQcm9qZWN0KHRoaXMpO1xuICAgICAgICBQcm9qZWN0LnNldEFjdGl2ZSh0aGlzKTtcbiAgICB9XG5cbiAgICBhZGRUb2RvKHRvZG8pIHtcbiAgICAgICAgdGhpcy4jdG9kb3MucHVzaCh0b2RvKTtcbiAgICAgICAgZGlzcGxheUNvbnRyb2xsZXIuYXBwZW5kVG9kbyh0b2RvKTtcbiAgICB9XG5cbiAgICByZW1vdmVUb2RvKGlkKSB7XG4gICAgICAgIHRoaXMuI3RvZG9zLnNwbGljZShcbiAgICAgICAgICAgIHRoaXMuI3RvZG9zLmZpbmRJbmRleCgodG9kbykgPT4gdG9kby5pZCA9PT0gaWQpLFxuICAgICAgICAgICAgMVxuICAgICAgICApO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5yZW1vdmVUb2RvKGlkKTtcbiAgICB9XG5cbiAgICBnZXRUb2RvKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiN0b2Rvcy5maW5kKCh0b2RvKSA9PiB0b2RvLmlkID09PSBpZCk7XG4gICAgfVxuXG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jaWQ7XG4gICAgfVxuXG4gICAgc3RhdGljIHNldEFjdGl2ZShwcm9qZWN0KSB7XG4gICAgICAgIFByb2plY3QuI2FjdGl2ZSA9IHByb2plY3Q7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLnNldEFjdGl2ZVByb2plY3QocHJvamVjdCk7XG4gICAgfVxuXG4gICAgZ2V0IHRvZG9zKCkge1xuICAgICAgICByZXR1cm4gWy4uLnRoaXMuI3RvZG9zXTtcbiAgICB9XG5cbiAgICBzdGF0aWMgI2FjdGl2ZTtcbiAgICBzdGF0aWMgZ2V0IGFjdGl2ZSgpIHtcbiAgICAgICAgcmV0dXJuIFByb2plY3QuI2FjdGl2ZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXJcIjtcbmltcG9ydCBQcm9qZWN0IGZyb20gXCIuL3Byb2plY3RcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9kbyB7XG4gICAgY2hlY2tlZCA9IGZhbHNlO1xuICAgICNpZCA9IG51bGw7XG4gICAgI3Byb2plY3QgPSBudWxsO1xuICAgIGNvbnN0cnVjdG9yKHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgdGhpcy5kdWVEYXRlID0gZHVlRGF0ZTtcbiAgICAgICAgdGhpcy4jaWQgPSBcImlkXCIgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zbGljZSgyKTtcbiAgICAgICAgdGhpcy4jcHJvamVjdCA9IFByb2plY3QuYWN0aXZlO1xuICAgIH1cblxuICAgIGVkaXQodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5lZGl0VG9kbyh0aGlzKTtcbiAgICB9XG5cbiAgICBkZWxldGUoKSB7XG4gICAgICAgIHRoaXMuI3Byb2plY3QucmVtb3ZlVG9kbyh0aGlzLiNpZCk7XG4gICAgfVxuXG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jaWQ7XG4gICAgfVxufVxuIiwiaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IFRvZG8gZnJvbSBcIi4vdG9kb1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpbml0UGFnZSgpIHtcbiAgICBjb25zdCBwcm9qZWN0cyA9IFtdO1xuXG4gICAgY29uc3QgcHJvamVjdDEgPSBuZXcgUHJvamVjdChcIlRvZGF5XCIpO1xuXG4gICAgY29uc3QgdG9kbzExID0gbmV3IFRvZG8oXG4gICAgICAgIFwiR28gb3V0IHdpdGggdHJhc2hcIixcbiAgICAgICAgXCJ0aGlzIGlzIHNvbWUgcmFuZG9tZSBub3Qgc28gc2hvcnQgZGVzY3JpcHRpb25cIixcbiAgICAgICAgMSxcbiAgICAgICAgbmV3IERhdGUoKVxuICAgICk7XG4gICAgY29uc3QgdG9kbzEyID0gbmV3IFRvZG8oXG4gICAgICAgIFwiR28gc2hvcHBpbmdcIixcbiAgICAgICAgXCJ0aGlzIGlzIHNvbWUgcmFuZG9tZSBsb25nZXIgZGVzY3JpcHRpb24gYWJvdXQgaG93IGF3ZXNvbWUgaXMgdGhpcyB0b2RvXCIsXG4gICAgICAgIDAsXG4gICAgICAgIG5ldyBEYXRlKClcbiAgICApO1xuXG4gICAgcHJvamVjdDEuYWRkVG9kbyh0b2RvMTEpO1xuICAgIHByb2plY3QxLmFkZFRvZG8odG9kbzEyKTtcblxuICAgIHByb2plY3RzLnB1c2gocHJvamVjdDEpO1xufVxuIiwiaW1wb3J0IGRpc3BsYXlDb250cm9sbGVyIGZyb20gXCIuL2Rpc3BsYXlDb250cm9sbGVyXCI7XG5pbXBvcnQgaW5pdFBhZ2UgZnJvbSBcIi4vbG9hZEluaXRcIjtcbmltcG9ydCBQcm9qZWN0IGZyb20gXCIuL3Byb2plY3RcIjtcbmltcG9ydCBUb2RvIGZyb20gXCIuL3RvZG9cIjtcblxuaW5pdFBhZ2UoKTtcblxuLyogRUxFTUVOVFMgKi9cbmNvbnN0IGFkZFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC10YXNrXCIpO1xuY29uc3QgdG9kb0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZm9ybVwiKTtcbmNvbnN0IHRvZG9zQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2Rvc1wiKTtcblxuLyogTElTVEVORVJTICovXG5hZGRUYXNrLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgZGlzcGxheUNvbnRyb2xsZXIudG9nZ2xlVG9kb0FkZEZvcm0oKTtcbn0pO1xuXG50b2RvRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZV0gPSBbXG4gICAgICAgIHRvZG9Gb3JtLnRpdGxlLnZhbHVlLFxuICAgICAgICB0b2RvRm9ybS5kZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgICAgdG9kb0Zvcm0ucHJpb3JpdHkudmFsdWUsXG4gICAgICAgIHRvZG9Gb3JtLmR1ZURhdGUudmFsdWUsXG4gICAgXTtcblxuICAgIGNvbnN0IHRvZG8gPSBuZXcgVG9kbyh0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKTtcbiAgICBQcm9qZWN0LmFjdGl2ZS5hZGRUb2RvKHRvZG8pO1xuICAgIHRvZG9Gb3JtLnJlc2V0KCk7XG4gICAgZGlzcGxheUNvbnRyb2xsZXIudG9nZ2xlVG9kb0FkZEZvcm0oKTtcbn0pO1xuXG50b2Rvc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGNvbnN0IHQgPSBldnQudGFyZ2V0O1xuICAgIGNvbnN0IHRvZG9ET00gPSB0LmNsb3Nlc3QoXCIudG9kb1wiKTtcbiAgICBjb25zdCB0b2RvID0gUHJvamVjdC5hY3RpdmUuZ2V0VG9kbyh0b2RvRE9NLmlkKTtcbiAgICBpZiAoIXRvZG9ET00pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHQudHlwZSA9PT0gXCJjaGVja2JveFwiKSB7XG4gICAgICAgIHRvZG8uY2hlY2tlZCA9IHQuY2hlY2tlZDtcbiAgICB9XG4gICAgaWYgKHQuY2xvc2VzdChcIi50b2RvLWJvZHlcIikpIHtcbiAgICAgICAgY29uc3QgdG9kb0Zvcm0gPSBkaXNwbGF5Q29udHJvbGxlci5zaG93RWRpdEZvcm0odG9kbyk7XG4gICAgICAgIGlmICh0b2RvRm9ybSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB0b2RvRm9ybS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgXCJzdWJtaXRcIixcbiAgICAgICAgICAgIChldnQpID0+IHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZV0gPSBbXG4gICAgICAgICAgICAgICAgICAgIHRvZG9Gb3JtLnRpdGxlLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICB0b2RvRm9ybS5kZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdG9kb0Zvcm0ucHJpb3JpdHkudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHRvZG9Gb3JtLmR1ZURhdGUudmFsdWVBc0RhdGUsXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB0b2RvLmVkaXQodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibWRpLXRyYXNoLWNhbi1vdXRsaW5lXCIpKSB7XG4gICAgICAgIHRvZG8uZGVsZXRlKCk7XG4gICAgfVxufSk7XG4iXSwibmFtZXMiOlsiYXBwZW5kVG9kbyIsInRvZG8iLCJ0b2RvRE9NIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInByaW9yaXR5IiwiZHVlRGF0ZSIsImlkIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwicHJpb3JpdHlET00iLCJ0eXBlIiwidG9kb0JvZHkiLCJ0b2RvVGl0bGUiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwidG9kb0Rlc2NyaXB0aW9uIiwic3Vic3RyIiwibGVuZ3RoIiwidG9kb0R1ZURhdGUiLCJjYWxlbmRhciIsInRvZG9EYXRlIiwiZGVsZXRlSWNvbiIsIl9jcmVhdGVUb2RvIiwicXVlcnlTZWxlY3RvciIsInRvZ2dsZVRvZG9BZGRGb3JtIiwidG9nZ2xlIiwiYXBwZW5kUHJvamVjdCIsInByb2plY3QiLCJwcm9qZWN0RE9NIiwicHJvamVjdE5hbWUiLCJfY3JlYXRlUHJvamVjdCIsInNldEFjdGl2ZVByb2plY3QiLCJhY3RpdmVQcm9qZWN0IiwicmVtb3ZlIiwiaW5uZXJIVE1MIiwiX3JlbW92ZUFjdGl2ZVByb2plY3QiLCJnZXRFbGVtZW50QnlJZCIsInRvZG9zIiwiZm9yRWFjaCIsIl9zaG93UHJvamVjdFRvZG9zIiwic2hvd0VkaXRGb3JtIiwiZGF0YXNldCIsInRvZG9Gb3JtIiwiY2xvbmVOb2RlIiwicmVzZXQiLCJfY2xvbmVUb2RvRm9ybSIsInZhbHVlIiwidmFsdWVBc0RhdGUiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJlZGl0VG9kbyIsInJlbW92ZVRvZG8iLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic2xpY2UiLCJkaXNwbGF5Q29udHJvbGxlciIsInNldEFjdGl2ZSIsImFkZFRvZG8iLCJwdXNoIiwic3BsaWNlIiwiZmluZEluZGV4IiwiZ2V0VG9kbyIsImZpbmQiLCJzdGF0aWMiLCJhY3RpdmUiLCJUb2RvIiwiY2hlY2tlZCIsImVkaXQiLCJkZWxldGUiLCJwcm9qZWN0MSIsInRvZG8xMSIsIkRhdGUiLCJ0b2RvMTIiLCJpbml0UGFnZSIsImFkZFRhc2siLCJ0b2Rvc0NvbnRhaW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInQiLCJ0YXJnZXQiLCJjbG9zZXN0Iiwib25jZSIsImNvbnRhaW5zIl0sInNvdXJjZVJvb3QiOiIifQ==