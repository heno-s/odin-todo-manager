(()=>{"use strict";function e(e){const d=function(e){const{title:d,description:i,priority:c,dueDate:s,id:n}=e,r=document.createElement("div");r.classList.add("todo");const a=document.createElement("input");a.type="checkbox",a.classList.add("priority"),o(a,c);const l=t(d,i,s),u=document.createElement("div");return u.classList.add("mdi"),u.classList.add("mdi-trash-can-outline"),console.log(l),r.appendChild(a),r.appendChild(l),r.appendChild(u),r.id=n,r}(e);document.querySelector(".todos").appendChild(d)}function t(e,t,o){const d=document.createElement("div");d.classList.add("todo-body");const i=document.createElement("div");if(i.classList.add("todo-title"),i.textContent=e,d.appendChild(i),t){const e=document.createElement("div");e.classList.add("todo-description"),e.textContent=t.substr(0,50)+(t.length>50?"...":""),d.appendChild(e)}if(o){const e=document.createElement("div");e.classList.add("todo-due-date");const t=document.createElement("div");t.classList.add("mdi"),t.classList.add("mdi-calendar-clock-outline");const i=document.createElement("div");i.classList.add("todo-date"),i.textContent=o,e.appendChild(t),e.appendChild(i),d.appendChild(e)}return d}function o(e,t){switch(+t){case 0:default:e.classList.add("priority-low");break;case 1:e.classList.add("priority-medium");break;case 2:e.classList.add("priority-high")}}const d={toggleTodoAddForm:function(){document.querySelector(".add-task").classList.toggle("hide");const e=document.querySelector("#todo-form");e.reset(),e.classList.toggle("hide")},toggleProjectForm:function(){document.querySelector(".add-project").classList.toggle("hide");const e=document.querySelector(".project-form");e.reset(),e.classList.toggle("hide")},appendProject:function(e){const t=function(e){const{title:t,id:o}=e,d=document.createElement("li");d.classList.add("project"),d.id=o;const i=document.createElement("span");i.classList.add("project-name"),i.textContent=t;const c=document.createElement("div");return c.classList.add("mdi"),c.classList.add("mdi-trash-can-outline"),d.appendChild(i),d.appendChild(c),d}(e);document.querySelector(".projects").appendChild(t)},setActiveProject:function(t){!function(){const e=document.querySelector(".project.active");e&&(e.classList.remove("active"),document.querySelector(".todos").innerHTML="")}(),document.getElementById(t.id).classList.add("active"),function(t){t.todos.forEach(e)}(t)},appendTodo:e,createEditForm:function(e){if(document.querySelector("#edit-form"))return null;const{title:t,description:o,priority:d,dueDate:i,id:c}=e,s=document.getElementById(e.id),n=function(){const e=document.querySelector("#todo-form").cloneNode(!0);return e.id="edit-form",e.reset(),e.classList.remove("hide"),e}();return n.dataset.id=c,n.title.value=t,n.description.value=o,n.priority.value=d,i&&(n.dueDate.valueAsDate=i),n.addEventListener("submit",(t=>{t.preventDefault();const[o,d,i,c]=[n.title.value,n.description.value,n.priority.value,n.dueDate.valueAsDate];e.edit(o,d,i,c)}),{once:!0}),n.querySelector(".close-form").addEventListener("click",(e=>{n.remove(),s.classList.remove("hide")}),{once:!0}),s.insertAdjacentElement("afterend",n),s.classList.add("hide"),n},editTodo:function(e){const{title:d,description:i,priority:c,id:s,dueDate:n}=e,r=document.getElementById(s);o(r.querySelector(".priority"),c);const a=t(d,i,n);r.querySelector(".todo-body").replaceWith(a),r.classList.remove("hide");const l=document.querySelector("#edit-form");return l&&l.remove(),!0},removeTodo:function(e){document.getElementById(e).remove()}};class i{#e=[];#t=0;constructor(e){this.title=e,this.#t="id"+Math.random().toString(16).slice(2)}addTodo(e){this.#e.push(e),d.appendTodo(e)}removeTodo(e){this.#e.splice(this.#e.findIndex((t=>t.id===e)),1),d.removeTodo(e)}getTodo(e){return this.#e.find((t=>t.id===e))}get id(){return this.#t}static setActive(e){i.#o=e,d.setActiveProject(e)}get todos(){return[...this.#e]}static#o;static get active(){return i.#o}}class c{checked=!1;#t=null;#d=null;constructor(e,t,o,d){this.title=e,this.description=t,this.priority=o,this.dueDate=d,this.#t="id"+Math.random().toString(16).slice(2),this.#d=i.active}edit(e,t,o,i){this.title=e,this.description=t,this.priority=o,this.dueDate=i,d.editTodo(this)}delete(){this.#d.removeTodo(this.#t)}get id(){return this.#t}}!function(){const e=new i("Today");d.appendProject(e),i.setActive(e);const t=new c("Go out with trash","this is some randome not so short description",1,new Date),o=new c("Go shopping","this is some randome longer description about how awesome is this todo",0,new Date);e.addTodo(t),e.addTodo(o)}();const s=document.querySelector(".add-task"),n=document.querySelector(".todo-form"),r=document.querySelector(".todos"),a=document.querySelector(".add-project"),l=document.querySelector(".project-form");a.addEventListener("click",d.toggleProjectForm),l.addEventListener("submit",(e=>{if(e.preventDefault(),l.projectTitle.value){const e=new i(l.projectTitle.value);d.appendProject(e),i.setActive(e)}d.toggleProjectForm()})),s.addEventListener("click",d.toggleTodoAddForm),n.querySelector(".close-form").addEventListener("click",d.toggleTodoAddForm),n.addEventListener("submit",(e=>{e.preventDefault();const[t,o,s,r]=[n.title.value,n.description.value,n.priority.value,n.dueDate.value],a=new c(t,o,s,r);i.active.addTodo(a),n.reset(),d.toggleTodoAddForm()})),r.addEventListener("click",(e=>{const t=e.target,o=t.closest(".todo"),c=i.active.getTodo(o.id);if(!o)return null;"checkbox"===t.type&&(c.checked=t.checked),t.closest(".todo-body")&&d.createEditForm(c),t.classList.contains("mdi-trash-can-outline")&&c.delete()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxHQUN2QmdDLEVBQVNDLFFBQ1QyQyxFQUFrQjlDLG1CQUFtQixJQUd6QytELEVBQWVwQyxpQkFBaUIsU0FBVUMsSUFDdEMsTUFBTXNDLEVBQUl0QyxFQUFJdUMsT0FDUmhHLEVBQVUrRixFQUFFRSxRQUFRLFNBQ3BCbEcsRUFBT21FLEVBQVFlLE9BQU9ILFFBQVE5RSxFQUFRSyxJQUM1QyxJQUFLTCxFQUNELE9BQU8sS0FHSSxhQUFYK0YsRUFBRXBGLE9BQ0ZaLEVBQUtvRixRQUFVWSxFQUFFWixTQUVqQlksRUFBRUUsUUFBUSxlQUNWdEIsRUFBa0IxQixlQUFlbEQsR0FFakNnRyxFQUFFdkYsVUFBVTBGLFNBQVMsMEJBQ3JCbkcsRUFBS3FGLFFBQ1QsRyIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL2Rpc3BsYXlDb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kby1tYW5hZ2VyLy4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLW1hbmFnZXIvLi9zcmMvdG9kby5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9sb2FkSW5pdC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbWFuYWdlci8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBhcHBlbmRQcm9qZWN0KHByb2plY3QpIHtcbiAgICBjb25zdCBwcm9qZWN0RE9NID0gX2NyZWF0ZVByb2plY3QocHJvamVjdCk7XG4gICAgY29uc3QgcHJvamVjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3RzXCIpO1xuICAgIHByb2plY3RzLmFwcGVuZENoaWxkKHByb2plY3RET00pO1xufVxuXG5mdW5jdGlvbiBfY3JlYXRlUHJvamVjdChwcm9qZWN0KSB7XG4gICAgY29uc3QgeyB0aXRsZSwgaWQgfSA9IHByb2plY3Q7XG4gICAgY29uc3QgcHJvamVjdERPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgICBwcm9qZWN0RE9NLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0XCIpO1xuICAgIHByb2plY3RET00uaWQgPSBpZDtcblxuICAgIGNvbnN0IHByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgcHJvamVjdE5hbWUuY2xhc3NMaXN0LmFkZChcInByb2plY3QtbmFtZVwiKTtcbiAgICBwcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9IHRpdGxlO1xuXG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKFwibWRpXCIpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZChcIm1kaS10cmFzaC1jYW4tb3V0bGluZVwiKTtcblxuICAgIHByb2plY3RET00uYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuICAgIHByb2plY3RET00uYXBwZW5kQ2hpbGQoZGVsZXRlSWNvbik7XG5cbiAgICByZXR1cm4gcHJvamVjdERPTTtcbn1cblxuZnVuY3Rpb24gc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0KSB7XG4gICAgX3JlbW92ZUFjdGl2ZVByb2plY3QoKTtcbiAgICBjb25zdCBwcm9qZWN0RE9NID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocHJvamVjdC5pZCk7XG4gICAgcHJvamVjdERPTS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIF9zaG93UHJvamVjdFRvZG9zKHByb2plY3QpO1xufVxuXG5mdW5jdGlvbiBfcmVtb3ZlQWN0aXZlUHJvamVjdCgpIHtcbiAgICBjb25zdCBhY3RpdmVQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LmFjdGl2ZVwiKTtcbiAgICBpZiAoIWFjdGl2ZVByb2plY3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhY3RpdmVQcm9qZWN0LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgX3JlbW92ZUN1cnJlbnRUb2RvcygpO1xufVxuXG5mdW5jdGlvbiBfcmVtb3ZlQ3VycmVudFRvZG9zKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmZ1bmN0aW9uIF9zaG93UHJvamVjdFRvZG9zKHByb2plY3QpIHtcbiAgICBjb25zdCB0b2RvcyA9IHByb2plY3QudG9kb3M7XG4gICAgdG9kb3MuZm9yRWFjaChhcHBlbmRUb2RvKTtcbn1cblxuZnVuY3Rpb24gYXBwZW5kVG9kbyh0b2RvKSB7XG4gICAgY29uc3QgdG9kb0RPTSA9IF9jcmVhdGVUb2RvKHRvZG8pO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0RPTSk7XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVUb2RvKHRvZG8pIHtcbiAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUsIGlkIH0gPSB0b2RvO1xuICAgIGNvbnN0IHRvZG9ET00gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9ET00uY2xhc3NMaXN0LmFkZChcInRvZG9cIik7XG5cbiAgICBjb25zdCBwcmlvcml0eURPTSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBwcmlvcml0eURPTS50eXBlID0gXCJjaGVja2JveFwiO1xuICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eVwiKTtcbiAgICBfc2V0UHJpb3JpdHkocHJpb3JpdHlET00sIHByaW9yaXR5KTtcblxuICAgIGNvbnN0IHRvZG9Cb2R5ID0gX2NyZWF0ZVRvZG9Cb2R5KHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSk7XG5cbiAgICBjb25zdCBkZWxldGVJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoXCJtZGlcIik7XG4gICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKFwibWRpLXRyYXNoLWNhbi1vdXRsaW5lXCIpO1xuICAgIGNvbnNvbGUubG9nKHRvZG9Cb2R5KTtcbiAgICB0b2RvRE9NLmFwcGVuZENoaWxkKHByaW9yaXR5RE9NKTtcbiAgICB0b2RvRE9NLmFwcGVuZENoaWxkKHRvZG9Cb2R5KTtcbiAgICB0b2RvRE9NLmFwcGVuZENoaWxkKGRlbGV0ZUljb24pO1xuXG4gICAgdG9kb0RPTS5pZCA9IGlkO1xuXG4gICAgcmV0dXJuIHRvZG9ET007XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZVRvZG9BZGRGb3JtKCkge1xuICAgIGNvbnN0IGFkZFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC10YXNrXCIpO1xuICAgIGFkZFRhc2suY2xhc3NMaXN0LnRvZ2dsZShcImhpZGVcIik7XG5cbiAgICBjb25zdCB0b2RvRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kby1mb3JtXCIpO1xuICAgIHRvZG9Gb3JtLnJlc2V0KCk7XG4gICAgdG9kb0Zvcm0uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGVcIik7XG59XG5cbmZ1bmN0aW9uIF9jbG9uZVRvZG9Gb3JtKCkge1xuICAgIGNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjdG9kby1mb3JtXCIpXG4gICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgdG9kb0Zvcm0uaWQgPSBcImVkaXQtZm9ybVwiO1xuICAgIHRvZG9Gb3JtLnJlc2V0KCk7XG4gICAgdG9kb0Zvcm0uY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG5cbiAgICByZXR1cm4gdG9kb0Zvcm07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUVkaXRGb3JtKHRvZG8pIHtcbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWZvcm1cIikpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSwgaWQgfSA9IHRvZG87XG4gICAgY29uc3QgdG9kb0RPTSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRvZG8uaWQpO1xuICAgIGNvbnN0IGVkaXRGb3JtID0gX2Nsb25lVG9kb0Zvcm0oKTtcblxuICAgIGVkaXRGb3JtLmRhdGFzZXQuaWQgPSBpZDtcbiAgICBlZGl0Rm9ybS50aXRsZS52YWx1ZSA9IHRpdGxlO1xuICAgIGVkaXRGb3JtLmRlc2NyaXB0aW9uLnZhbHVlID0gZGVzY3JpcHRpb247XG4gICAgZWRpdEZvcm0ucHJpb3JpdHkudmFsdWUgPSBwcmlvcml0eTtcbiAgICBpZiAoZHVlRGF0ZSkge1xuICAgICAgICBlZGl0Rm9ybS5kdWVEYXRlLnZhbHVlQXNEYXRlID0gZHVlRGF0ZTtcbiAgICB9XG5cbiAgICBlZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcInN1Ym1pdFwiLFxuICAgICAgICAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlXSA9IFtcbiAgICAgICAgICAgICAgICBlZGl0Rm9ybS50aXRsZS52YWx1ZSxcbiAgICAgICAgICAgICAgICBlZGl0Rm9ybS5kZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICBlZGl0Rm9ybS5wcmlvcml0eS52YWx1ZSxcbiAgICAgICAgICAgICAgICBlZGl0Rm9ybS5kdWVEYXRlLnZhbHVlQXNEYXRlLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHRvZG8uZWRpdCh0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKTtcbiAgICAgICAgfSxcbiAgICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICApO1xuXG4gICAgZWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcIi5jbG9zZS1mb3JtXCIpLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwiY2xpY2tcIixcbiAgICAgICAgKGUpID0+IHtcbiAgICAgICAgICAgIGVkaXRGb3JtLnJlbW92ZSgpO1xuICAgICAgICAgICAgdG9kb0RPTS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICApO1xuXG4gICAgdG9kb0RPTS5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJhZnRlcmVuZFwiLCBlZGl0Rm9ybSk7XG4gICAgdG9kb0RPTS5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcblxuICAgIHJldHVybiBlZGl0Rm9ybTtcbn1cblxuZnVuY3Rpb24gZWRpdFRvZG8odG9kbykge1xuICAgIGNvbnN0IHsgdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgaWQsIGR1ZURhdGUgfSA9IHRvZG87XG5cbiAgICBjb25zdCB0b2RvRE9NID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIF9zZXRQcmlvcml0eSh0b2RvRE9NLnF1ZXJ5U2VsZWN0b3IoXCIucHJpb3JpdHlcIiksIHByaW9yaXR5KTtcbiAgICBjb25zdCB0b2RvQm9keSA9IF9jcmVhdGVUb2RvQm9keSh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUpO1xuICAgIHRvZG9ET00ucXVlcnlTZWxlY3RvcihcIi50b2RvLWJvZHlcIikucmVwbGFjZVdpdGgodG9kb0JvZHkpO1xuXG4gICAgdG9kb0RPTS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICBjb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1mb3JtXCIpO1xuICAgIGVkaXRGb3JtICYmIGVkaXRGb3JtLnJlbW92ZSgpO1xuICAgIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiByZW1vdmVUb2RvKGlkKSB7XG4gICAgY29uc3QgdG9kbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICB0b2RvLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVQcm9qZWN0Rm9ybSgpIHtcbiAgICBjb25zdCBhZGRQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcHJvamVjdFwiKTtcbiAgICBhZGRQcm9qZWN0LmNsYXNzTGlzdC50b2dnbGUoXCJoaWRlXCIpO1xuXG4gICAgY29uc3QgcHJvamVjdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtZm9ybVwiKTtcbiAgICBwcm9qZWN0Rm9ybS5yZXNldCgpO1xuICAgIHByb2plY3RGb3JtLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRlXCIpO1xufVxuXG5mdW5jdGlvbiBfY3JlYXRlVG9kb0JvZHkodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlKSB7XG4gICAgY29uc3QgdG9kb0JvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9Cb2R5LmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWJvZHlcIik7XG5cbiAgICBjb25zdCB0b2RvVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRvZG9UaXRsZS5jbGFzc0xpc3QuYWRkKFwidG9kby10aXRsZVwiKTtcbiAgICB0b2RvVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcblxuICAgIHRvZG9Cb2R5LmFwcGVuZENoaWxkKHRvZG9UaXRsZSk7XG5cbiAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgY29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdG9kb0Rlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICB0b2RvRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgZGVzY3JpcHRpb24uc3Vic3RyKDAsIDUwKSArXG4gICAgICAgICAgICAoZGVzY3JpcHRpb24ubGVuZ3RoID4gNTAgPyBcIi4uLlwiIDogXCJcIik7XG5cbiAgICAgICAgdG9kb0JvZHkuYXBwZW5kQ2hpbGQodG9kb0Rlc2NyaXB0aW9uKTtcbiAgICB9XG4gICAgaWYgKGR1ZURhdGUpIHtcbiAgICAgICAgY29uc3QgdG9kb0R1ZURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0b2RvRHVlRGF0ZS5jbGFzc0xpc3QuYWRkKFwidG9kby1kdWUtZGF0ZVwiKTtcblxuICAgICAgICBjb25zdCBjYWxlbmRhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGlcIik7XG4gICAgICAgIGNhbGVuZGFyLmNsYXNzTGlzdC5hZGQoXCJtZGktY2FsZW5kYXItY2xvY2stb3V0bGluZVwiKTtcblxuICAgICAgICBjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRvZG9EYXRlLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRhdGVcIik7XG4gICAgICAgIHRvZG9EYXRlLnRleHRDb250ZW50ID0gZHVlRGF0ZTtcblxuICAgICAgICB0b2RvRHVlRGF0ZS5hcHBlbmRDaGlsZChjYWxlbmRhcik7XG4gICAgICAgIHRvZG9EdWVEYXRlLmFwcGVuZENoaWxkKHRvZG9EYXRlKTtcblxuICAgICAgICB0b2RvQm9keS5hcHBlbmRDaGlsZCh0b2RvRHVlRGF0ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRvZG9Cb2R5O1xufVxuXG5mdW5jdGlvbiBfc2V0UHJpb3JpdHkocHJpb3JpdHlET00sIHByaW9yaXR5KSB7XG4gICAgc3dpdGNoICgrcHJpb3JpdHkpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcHJpb3JpdHlET00uY2xhc3NMaXN0LmFkZChcInByaW9yaXR5LWxvd1wiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktbWVkaXVtXCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHByaW9yaXR5RE9NLmNsYXNzTGlzdC5hZGQoXCJwcmlvcml0eS1oaWdoXCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBwcmlvcml0eURPTS5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktbG93XCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgdG9nZ2xlVG9kb0FkZEZvcm0sXG4gICAgdG9nZ2xlUHJvamVjdEZvcm0sXG4gICAgYXBwZW5kUHJvamVjdCxcbiAgICBzZXRBY3RpdmVQcm9qZWN0LFxuICAgIGFwcGVuZFRvZG8sXG4gICAgY3JlYXRlRWRpdEZvcm0sXG4gICAgZWRpdFRvZG8sXG4gICAgcmVtb3ZlVG9kbyxcbn07XG4iLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSBcIi4vZGlzcGxheUNvbnRyb2xsZXIuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvamVjdCB7XG4gICAgI3RvZG9zID0gW107XG4gICAgI2lkID0gMDtcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuI2lkID0gXCJpZFwiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMik7XG4gICAgfVxuXG4gICAgYWRkVG9kbyh0b2RvKSB7XG4gICAgICAgIHRoaXMuI3RvZG9zLnB1c2godG9kbyk7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmFwcGVuZFRvZG8odG9kbyk7XG4gICAgfVxuXG4gICAgcmVtb3ZlVG9kbyhpZCkge1xuICAgICAgICB0aGlzLiN0b2Rvcy5zcGxpY2UoXG4gICAgICAgICAgICB0aGlzLiN0b2Rvcy5maW5kSW5kZXgoKHRvZG8pID0+IHRvZG8uaWQgPT09IGlkKSxcbiAgICAgICAgICAgIDFcbiAgICAgICAgKTtcbiAgICAgICAgZGlzcGxheUNvbnRyb2xsZXIucmVtb3ZlVG9kbyhpZCk7XG4gICAgfVxuXG4gICAgZ2V0VG9kbyhpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jdG9kb3MuZmluZCgodG9kbykgPT4gdG9kby5pZCA9PT0gaWQpO1xuICAgIH1cblxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2lkO1xuICAgIH1cblxuICAgIHN0YXRpYyBzZXRBY3RpdmUocHJvamVjdCkge1xuICAgICAgICBQcm9qZWN0LiNhY3RpdmUgPSBwcm9qZWN0O1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5zZXRBY3RpdmVQcm9qZWN0KHByb2plY3QpO1xuICAgIH1cblxuICAgIGdldCB0b2RvcygpIHtcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLiN0b2Rvc107XG4gICAgfVxuXG4gICAgc3RhdGljICNhY3RpdmU7XG4gICAgc3RhdGljIGdldCBhY3RpdmUoKSB7XG4gICAgICAgIHJldHVybiBQcm9qZWN0LiNhY3RpdmU7XG4gICAgfVxufVxuIiwiaW1wb3J0IGRpc3BsYXlDb250cm9sbGVyIGZyb20gXCIuL2Rpc3BsYXlDb250cm9sbGVyXCI7XG5pbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9wcm9qZWN0XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvZG8ge1xuICAgIGNoZWNrZWQgPSBmYWxzZTtcbiAgICAjaWQgPSBudWxsO1xuICAgICNwcm9qZWN0ID0gbnVsbDtcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBkdWVEYXRlKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgICAgIHRoaXMuZHVlRGF0ZSA9IGR1ZURhdGU7XG4gICAgICAgIHRoaXMuI2lkID0gXCJpZFwiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMik7XG4gICAgICAgIHRoaXMuI3Byb2plY3QgPSBQcm9qZWN0LmFjdGl2ZTtcbiAgICB9XG5cbiAgICBlZGl0KHRpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgdGhpcy5kdWVEYXRlID0gZHVlRGF0ZTtcbiAgICAgICAgZGlzcGxheUNvbnRyb2xsZXIuZWRpdFRvZG8odGhpcyk7XG4gICAgfVxuXG4gICAgZGVsZXRlKCkge1xuICAgICAgICB0aGlzLiNwcm9qZWN0LnJlbW92ZVRvZG8odGhpcy4jaWQpO1xuICAgIH1cblxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2lkO1xuICAgIH1cbn1cbiIsImltcG9ydCBkaXNwbGF5Q29udHJvbGxlciBmcm9tIFwiLi9kaXNwbGF5Q29udHJvbGxlclwiO1xuaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IFRvZG8gZnJvbSBcIi4vdG9kb1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpbml0UGFnZSgpIHtcbiAgICBjb25zdCBwcm9qZWN0MSA9IG5ldyBQcm9qZWN0KFwiVG9kYXlcIik7XG4gICAgZGlzcGxheUNvbnRyb2xsZXIuYXBwZW5kUHJvamVjdChwcm9qZWN0MSk7XG4gICAgUHJvamVjdC5zZXRBY3RpdmUocHJvamVjdDEpO1xuXG4gICAgY29uc3QgdG9kbzExID0gbmV3IFRvZG8oXG4gICAgICAgIFwiR28gb3V0IHdpdGggdHJhc2hcIixcbiAgICAgICAgXCJ0aGlzIGlzIHNvbWUgcmFuZG9tZSBub3Qgc28gc2hvcnQgZGVzY3JpcHRpb25cIixcbiAgICAgICAgMSxcbiAgICAgICAgbmV3IERhdGUoKVxuICAgICk7XG4gICAgY29uc3QgdG9kbzEyID0gbmV3IFRvZG8oXG4gICAgICAgIFwiR28gc2hvcHBpbmdcIixcbiAgICAgICAgXCJ0aGlzIGlzIHNvbWUgcmFuZG9tZSBsb25nZXIgZGVzY3JpcHRpb24gYWJvdXQgaG93IGF3ZXNvbWUgaXMgdGhpcyB0b2RvXCIsXG4gICAgICAgIDAsXG4gICAgICAgIG5ldyBEYXRlKClcbiAgICApO1xuXG4gICAgcHJvamVjdDEuYWRkVG9kbyh0b2RvMTEpO1xuICAgIHByb2plY3QxLmFkZFRvZG8odG9kbzEyKTtcbn1cbiIsImltcG9ydCBkaXNwbGF5Q29udHJvbGxlciBmcm9tIFwiLi9kaXNwbGF5Q29udHJvbGxlclwiO1xuaW1wb3J0IGluaXRQYWdlIGZyb20gXCIuL2xvYWRJbml0XCI7XG5pbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9wcm9qZWN0XCI7XG5pbXBvcnQgVG9kbyBmcm9tIFwiLi90b2RvXCI7XG5cbmluaXRQYWdlKCk7XG5cbi8qIEVMRU1FTlRTICovXG5jb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtdGFza1wiKTtcbmNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLWZvcm1cIik7XG5jb25zdCB0b2Rvc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb3NcIik7XG5jb25zdCBhZGRQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcHJvamVjdFwiKTtcbmNvbnN0IHByb2plY3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWZvcm1cIik7XG5cbi8qIExJU1RFTkVSUyAqL1xuXG5hZGRQcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJjbGlja1wiLFxuICAgIGRpc3BsYXlDb250cm9sbGVyLnRvZ2dsZVByb2plY3RGb3JtXG4pO1xuXG5wcm9qZWN0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAocHJvamVjdEZvcm0ucHJvamVjdFRpdGxlLnZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBuZXcgUHJvamVjdChwcm9qZWN0Rm9ybS5wcm9qZWN0VGl0bGUudmFsdWUpO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5hcHBlbmRQcm9qZWN0KHByb2plY3QpO1xuICAgICAgICBQcm9qZWN0LnNldEFjdGl2ZShwcm9qZWN0KTtcbiAgICB9XG4gICAgZGlzcGxheUNvbnRyb2xsZXIudG9nZ2xlUHJvamVjdEZvcm0oKTtcbn0pO1xuXG5hZGRUYXNrLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJjbGlja1wiLFxuICAgIGRpc3BsYXlDb250cm9sbGVyLnRvZ2dsZVRvZG9BZGRGb3JtXG4pO1xuXG50b2RvRm9ybVxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlLWZvcm1cIilcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGRpc3BsYXlDb250cm9sbGVyLnRvZ2dsZVRvZG9BZGRGb3JtKTtcblxudG9kb0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgW3RpdGxlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIGR1ZURhdGVdID0gW1xuICAgICAgICB0b2RvRm9ybS50aXRsZS52YWx1ZSxcbiAgICAgICAgdG9kb0Zvcm0uZGVzY3JpcHRpb24udmFsdWUsXG4gICAgICAgIHRvZG9Gb3JtLnByaW9yaXR5LnZhbHVlLFxuICAgICAgICB0b2RvRm9ybS5kdWVEYXRlLnZhbHVlLFxuICAgIF07XG5cbiAgICBjb25zdCB0b2RvID0gbmV3IFRvZG8odGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSk7XG4gICAgUHJvamVjdC5hY3RpdmUuYWRkVG9kbyh0b2RvKTtcbiAgICB0b2RvRm9ybS5yZXNldCgpO1xuICAgIGRpc3BsYXlDb250cm9sbGVyLnRvZ2dsZVRvZG9BZGRGb3JtKCk7XG59KTtcblxudG9kb3NDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBjb25zdCB0ID0gZXZ0LnRhcmdldDtcbiAgICBjb25zdCB0b2RvRE9NID0gdC5jbG9zZXN0KFwiLnRvZG9cIik7XG4gICAgY29uc3QgdG9kbyA9IFByb2plY3QuYWN0aXZlLmdldFRvZG8odG9kb0RPTS5pZCk7XG4gICAgaWYgKCF0b2RvRE9NKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmICh0LnR5cGUgPT09IFwiY2hlY2tib3hcIikge1xuICAgICAgICB0b2RvLmNoZWNrZWQgPSB0LmNoZWNrZWQ7XG4gICAgfVxuICAgIGlmICh0LmNsb3Nlc3QoXCIudG9kby1ib2R5XCIpKSB7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmNyZWF0ZUVkaXRGb3JtKHRvZG8pO1xuICAgIH1cbiAgICBpZiAodC5jbGFzc0xpc3QuY29udGFpbnMoXCJtZGktdHJhc2gtY2FuLW91dGxpbmVcIikpIHtcbiAgICAgICAgdG9kby5kZWxldGUoKTtcbiAgICB9XG59KTtcbiJdLCJuYW1lcyI6WyJhcHBlbmRUb2RvIiwidG9kbyIsInRvZG9ET00iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicHJpb3JpdHkiLCJkdWVEYXRlIiwiaWQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcmlvcml0eURPTSIsInR5cGUiLCJfc2V0UHJpb3JpdHkiLCJ0b2RvQm9keSIsIl9jcmVhdGVUb2RvQm9keSIsImRlbGV0ZUljb24iLCJjb25zb2xlIiwibG9nIiwiYXBwZW5kQ2hpbGQiLCJfY3JlYXRlVG9kbyIsInF1ZXJ5U2VsZWN0b3IiLCJ0b2RvVGl0bGUiLCJ0ZXh0Q29udGVudCIsInRvZG9EZXNjcmlwdGlvbiIsInN1YnN0ciIsImxlbmd0aCIsInRvZG9EdWVEYXRlIiwiY2FsZW5kYXIiLCJ0b2RvRGF0ZSIsInRvZ2dsZVRvZG9BZGRGb3JtIiwidG9nZ2xlIiwidG9kb0Zvcm0iLCJyZXNldCIsInRvZ2dsZVByb2plY3RGb3JtIiwicHJvamVjdEZvcm0iLCJhcHBlbmRQcm9qZWN0IiwicHJvamVjdCIsInByb2plY3RET00iLCJwcm9qZWN0TmFtZSIsIl9jcmVhdGVQcm9qZWN0Iiwic2V0QWN0aXZlUHJvamVjdCIsImFjdGl2ZVByb2plY3QiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJfcmVtb3ZlQWN0aXZlUHJvamVjdCIsImdldEVsZW1lbnRCeUlkIiwidG9kb3MiLCJmb3JFYWNoIiwiX3Nob3dQcm9qZWN0VG9kb3MiLCJjcmVhdGVFZGl0Rm9ybSIsImVkaXRGb3JtIiwiY2xvbmVOb2RlIiwiX2Nsb25lVG9kb0Zvcm0iLCJkYXRhc2V0IiwidmFsdWUiLCJ2YWx1ZUFzRGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVkaXQiLCJvbmNlIiwiZSIsImluc2VydEFkamFjZW50RWxlbWVudCIsImVkaXRUb2RvIiwicmVwbGFjZVdpdGgiLCJyZW1vdmVUb2RvIiwiUHJvamVjdCIsImNvbnN0cnVjdG9yIiwidGhpcyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInNsaWNlIiwiYWRkVG9kbyIsInB1c2giLCJkaXNwbGF5Q29udHJvbGxlciIsInNwbGljZSIsImZpbmRJbmRleCIsImdldFRvZG8iLCJmaW5kIiwic3RhdGljIiwiYWN0aXZlIiwiVG9kbyIsImNoZWNrZWQiLCJkZWxldGUiLCJwcm9qZWN0MSIsInNldEFjdGl2ZSIsInRvZG8xMSIsIkRhdGUiLCJ0b2RvMTIiLCJpbml0UGFnZSIsImFkZFRhc2siLCJ0b2Rvc0NvbnRhaW5lciIsImFkZFByb2plY3QiLCJwcm9qZWN0VGl0bGUiLCJ0IiwidGFyZ2V0IiwiY2xvc2VzdCIsImNvbnRhaW5zIl0sInNvdXJjZVJvb3QiOiIifQ==